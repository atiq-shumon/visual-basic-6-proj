create or replace procedure Rpt_Ln_Register(p_test_cursor in out
test_package.test_type,
P_EmpID varchar2
)
as
begin
If P_EmpID is null then
open p_test_cursor for
	SELECT LOANINFORMATION_MAIN.LOAN_ID,LOANINFORMATION_MAIN.eMP_ID,LOANINFORMATION_MAIN.LOANISSUEDATE, 
	LOANINFORMATION_MAIN.ISSUEDAMOUNT,LOANINFORMATION_MAIN.NOOFINSTALLMENT, 
	LOANINFORMATION_MAIN.SLABINSTALLMENTAMOUNT,LOANINFORMATION_SUB.LOANREFUNDEDDATE, 
	LOANINFORMATION_SUB.NOOFINTALLMENTPAID, 
	LOANINFORMATION_SUB.AMOUNTPAID, LOANINFORMATION_SUB.CURRENTBALANCE, 
	LOANINFORMATION_SUB.LOANREFUNDNO, LOANINFORMATION_SUB.NOTES
	FROM LOANINFORMATION_MAIN, LOANINFORMATION_SUB
	WHERE (LOANINFORMATION_MAIN.EMP_ID=LOANINFORMATION_SUB.EMP_ID)
	AND  LOANINFORMATION_SUB.CURRENTBALANCE<>0;
else
open p_test_cursor for

	SELECT LOANINFORMATION_MAIN.LOAN_ID,LOANINFORMATION_MAIN.eMP_ID,LOANINFORMATION_MAIN.LOANISSUEDATE, 
	LOANINFORMATION_MAIN.ISSUEDAMOUNT,LOANINFORMATION_MAIN.NOOFINSTALLMENT, 
	LOANINFORMATION_MAIN.SLABINSTALLMENTAMOUNT,LOANINFORMATION_SUB.LOANREFUNDEDDATE, 
	LOANINFORMATION_SUB.NOOFINTALLMENTPAID, 
	LOANINFORMATION_SUB.AMOUNTPAID, LOANINFORMATION_SUB.CURRENTBALANCE, 
	LOANINFORMATION_SUB.LOANREFUNDNO, LOANINFORMATION_SUB.NOTES
	FROM LOANINFORMATION_MAIN, LOANINFORMATION_SUB
	WHERE ((LOANINFORMATION_MAIN.EMP_ID=LOANINFORMATION_SUB.EMP_ID)
	and (LOANINFORMATION_MAIN.Emp_Id=P_EmpID)
	AND  LOANINFORMATION_SUB.CURRENTBALANCE<>0);
end if ;

end Rpt_Ln_Register;
