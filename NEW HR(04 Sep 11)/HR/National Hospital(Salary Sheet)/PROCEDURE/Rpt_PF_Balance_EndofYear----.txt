create or replace procedure Rpt_PF_Bal_EndofYear(p_test_cursor in out
test_package.test_type,
P_EmpID varchar2,
P_BEGIN_YEAR varchar2,
P_END_YEAR varchar2
)
as
var_temp number;
Var_Retirement number;
begin
begin
If P_EmpID is null then
open p_test_cursor for

	SELECT CLOSING_PF_BALANCE.BEGIN_YEAR, 
	CLOSING_PF_BALANCE.END_YEAR,CLOSING_PF_BALANCE.EMP_CONTRUBUTION, 
	CLOSING_PF_BALANCE.EMPLOYEER_CONTRIBUTION, 
	CLOSING_PF_BALANCE.INTEREST_AMOUNT,CLOSING_PF_BALANCE.CLOSEING_AMOUNT,CLOSING_PF_BALANCE.OPENING_AMOUNT, 
	ST_DESIG.DESIGNATION,ST_DEPT.DEPT_NM, 
	EMP_INFO.EMP_NM,CLOSING_PF_BALANCE.EMP_ID
	FROM CLOSING_PF_BALANCE,EMP_JOB_INFO, 
	ST_DEPT,ST_DESIG,EMP_INFO
	WHERE ((CLOSING_PF_BALANCE.EMP_ID=EMP_JOB_INFO.EMP_ID)
	AND (EMP_JOB_INFO.DESIG=ST_DESIG.DESIG_CODE)
	AND (EMP_JOB_INFO.DEPT=ST_DEPT.DEPT_CODE)
	AND (CLOSING_PF_BALANCE.EMP_ID=EMP_INFO.EMP_ID)
	AND CLOSING_PF_BALANCE.BEGIN_YEAR=P_BEGIN_YEAR 
	AND CLOSING_PF_BALANCE.END_YEAR=P_END_YEAR);


	
else
open p_test_cursor for
	SELECT CLOSING_PF_BALANCE.BEGIN_YEAR, 
	CLOSING_PF_BALANCE.END_YEAR,CLOSING_PF_BALANCE.EMP_CONTRUBUTION, 
	CLOSING_PF_BALANCE.EMPLOYEER_CONTRIBUTION, 
	CLOSING_PF_BALANCE.INTEREST_AMOUNT,CLOSING_PF_BALANCE.CLOSEING_AMOUNT,CLOSING_PF_BALANCE.OPENING_AMOUNT, 
	ST_DESIG.DESIGNATION,ST_DEPT.DEPT_NM, 
	EMP_INFO.EMP_NM,CLOSING_PF_BALANCE.EMP_ID
	FROM CLOSING_PF_BALANCE,EMP_JOB_INFO, 
	ST_DEPT,ST_DESIG,EMP_INFO
	WHERE ((CLOSING_PF_BALANCE.EMP_ID=EMP_JOB_INFO.EMP_ID)
	AND (EMP_JOB_INFO.DESIG=ST_DESIG.DESIG_CODE)
	AND (EMP_JOB_INFO.DEPT=ST_DEPT.DEPT_CODE)
	AND (CLOSING_PF_BALANCE.EMP_ID=EMP_INFO.EMP_ID)
	AND CLOSING_PF_BALANCE.BEGIN_YEAR=P_BEGIN_YEAR 
	AND CLOSING_PF_BALANCE.END_YEAR=P_END_YEAR
	AND CLOSING_PF_BALANCE.EMP_id=P_EmpID
	AND CLOSING_PF_BALANCE.TRACK_ID=(sELECT MAX(TRACK_ID) FROM CLOSING_PF_BALANCE 
	WHERE EMP_ID=P_EmpID));
end if ;
end ;
end Rpt_PF_Bal_EndofYear;
