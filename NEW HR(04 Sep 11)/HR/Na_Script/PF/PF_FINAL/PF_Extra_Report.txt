--PF RECEIVE SOURCE_OF_FUND WISE

CREATE OR REPLACE  PROCEDURE RPT_PFRECEIVE_SOURCE_OF_FUND
(p_test_cursor in out
test_package.test_type,
P_SOURCE_OF_FUND VARCHAR2,
P_BEGIN_DATE DATE,
P_END_DATE DATE
)
as
begin
open p_test_cursor for 
SELECT
PF_RECEIVE_ID,
(SELECT LS.SOURCE_NAME FROM L_SOURCE_OF_FUND LS WHERE SOURCE_OF_FUND=LS.SOURCE_ID) AS SOURCE_OF_FUND,
DESCRIPTION,
RECEIVE_DATE,
RECEIVED_AMOUNT,
RECEIVE_TYPE,
CHECK_NO,
ACCOUNT_NO,
(SELECT LB.BANK_NAME FROM L_BANK LB WHERE BANK_CODE=LB.BANK_ID) AS BANK_CODE,
VOUCHER_NO,
(SELECT LA.TYPE_NAME FROM L_ACCOUNT_TYPE LA WHERE ACCOUNT_TYPE=LA.TYPE_ID) AS ACCOUNT_TYPE
FROM
PF_RECEIVE
WHERE 
SOURCE_OF_FUND=P_SOURCE_OF_FUND 
AND RECEIVE_DATE BETWEEN P_BEGIN_DATE AND P_END_DATE;
END RPT_PFRECEIVE_SOURCE_OF_FUND;
/


--PF PAYMENT PURPOSE_OF_PAYMENT WISE

CREATE OR REPLACE  PROCEDURE RPT_PF_PURPOSE_OF_PAYMENT_WISE
(p_test_cursor in out
test_package.test_type,
P_PURPOSE_OF_PAYMENT VARCHAR2,
P_BEGIN_DATE DATE,
P_END_DATE DATE
)
as
begin
open p_test_cursor for 
SELECT 
PF_PAYMENT_ID,
(SELECT LP.PURPOSE_NAME FROM L_PF_PAYMENT_PURPOSE LP WHERE PURPOSE_OF_PAYMENT=LP.PURPOSE_ID) AS PURPOSE_OF_PAYMENT,
DESCRIPTION,
PAYMENT_DATE,
PAYMENT_AMOUNT,
PAYMENT_TYPE,
CHECK_NO,
ACCOUNT_NO,
(SELECT LB.BANK_NAME FROM L_BANK LB WHERE BANK_CODE=LB.BANK_ID) AS BANK_CODE,
VOUCHER_NO,
(SELECT LA.TYPE_NAME FROM L_ACCOUNT_TYPE LA WHERE ACCOUNT_TYPE=LA.TYPE_ID) AS ACCOUNT_TYPE 
FROM 
PF_PAYMENT  
WHERE 
PURPOSE_OF_PAYMENT=P_PURPOSE_OF_PAYMENT 
AND PAYMENT_DATE BETWEEN P_BEGIN_DATE AND P_END_DATE;
END RPT_PF_PURPOSE_OF_PAYMENT_WISE; 

/

--===========================End of Pf Extra report===============










//PF RECEIVE BANK WISE

CREATE OR REPLACE  PROCEDURE RPT_PF_RECEIVE_BANK_WISE
(p_test_cursor in out
test_package.test_type,
P_BANK_CODE VARCHAR2,
P_BEGIN_DATE DATE,
P_END_DATE DATE
)
as
begin
open p_test_cursor for 
SELECT
PF_RECEIVE_ID,
(SELECT LS.SOURCE_NAME FROM L_SOURCE_OF_FUND LS WHERE SOURCE_OF_FUND=LS.SOURCE_ID) AS SOURCE_OF_FUND,
DESCRIPTION,
RECEIVE_DATE,
RECEIVED_AMOUNT,
RECEIVE_TYPE,
CHECK_NO,
ACCOUNT_NO,
(SELECT LB.BANK_NAME FROM L_BANK LB WHERE BANK_CODE=LB.BANK_ID) AS BANK_CODE,
VOUCHER_NO,
(SELECT LA.TYPE_NAME FROM L_ACCOUNT_TYPE LA WHERE ACCOUNT_TYPE=LA.TYPE_ID) AS ACCOUNT_TYPE
FROM
PF_RECEIVE
WHERE
BANK_CODE=P_BANK_CODE 
AND RECEIVE_DATE BETWEEN P_BEGIN_DATE AND P_END_DATE;
END RPT_PF_RECEIVE_BANK_WISE;







// PF PAYMENT BANK WISE
CREATE OR REPLACE  PROCEDURE RPT_PF_PAYMENT_BANK_WISE
(p_test_cursor in out
test_package.test_type,
P_BANK_CODE VARCHAR2,
P_BEGIN_DATE DATE,
P_END_DATE DATE
)
as
begin
open p_test_cursor for 
SELECT 
PF_PAYMENT_ID,
(SELECT LP.PURPOSE_NAME FROM L_PAYMENT_PURPOSE LP WHERE PURPOSE_OF_PAYMENT=LP.PURPOSE_ID) AS PURPOSE_OF_PAYMENT,
DESCRIPTION,
PAYMENT_DATE,
PAYMENT_AMOUNT,
PAYMENT_TYPE,
CHECK_NO,
ACCOUNT_NO,
(SELECT LB.BANK_NAME FROM L_BANK LB WHERE BANK_CODE=LB.BANK_ID) AS BANK_CODE,
VOUCHER_NO,
(SELECT LA.TYPE_NAME FROM L_ACCOUNT_TYPE LA WHERE ACCOUNT_TYPE=LA.TYPE_ID) AS ACCOUNT_TYPE 
FROM 
PF_PAYMENT  
WHERE 
BANK_CODE=P_BANK_CODE
AND PAYMENT_DATE BETWEEN P_BEGIN_DATE AND P_END_DATE;
END RPT_PF_PAYMENT_BANK_WISE; 

