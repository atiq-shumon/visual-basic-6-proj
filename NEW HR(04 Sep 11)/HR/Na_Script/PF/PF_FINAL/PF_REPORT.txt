
--==== RPT_PF_INCOME_EXPENCE

CREATE OR REPLACE  PROCEDURE RPT_PF_INCOME_EXPENCE
(p_test_cursor in out
test_package.test_type,
P_BEGIN_DATE DATE,
P_END_DATE DATE
)
as
begin
open p_test_cursor for 

SELECT 
PF_RECEIVE_ID AS ID,
DESCRIPTION AS DES,
RECEIVE_DATE AS RDATE,
RECEIVED_AMOUNT AS R_AMOUNT,0 AS P_AMOUNT
FROM
PF_RECEIVE WHERE RECEIVE_DATE BETWEEN P_BEGIN_DATE AND P_END_DATE 
GROUP BY  
PF_RECEIVE_ID,DESCRIPTION,RECEIVE_DATE,RECEIVED_AMOUNT 
UNION 
SELECT 
PF_PAYMENT_ID AS ID,
DESCRIPTION DES,
PAYMENT_DATE AS RDATE,
0 AS R_AMOUNT,PAYMENT_AMOUNT AS P_AMOUNT
FROM 
PF_PAYMENT WHERE PAYMENT_DATE BETWEEN P_BEGIN_DATE AND P_END_DATE 
GROUP BY 
PF_PAYMENT_ID,DESCRIPTION,PAYMENT_DATE,PAYMENT_AMOUNT;
end RPT_PF_INCOME_EXPENCE;

/



--VARIABLE C REFCURSOR;
--EXEC RPT_PF_INCOME_EXPENCE(:C,'01-JUL-2005','30-JUN-2006');
--PRINT C;


--======= RPT_PF_CASHBOOK
CREATE OR REPLACE  PROCEDURE RPT_PF_CASHBOOK
(p_test_cursor in out
test_package.test_type,
P_BEGIN_DATE DATE,
P_END_DATE DATE
)
as
begin
open p_test_cursor for
SELECT
0 AS ID,
'Opening Balance' AS DES,
P_BEGIN_DATE AS RDATE,
SUM(AMOUNT) AS MR_AMOUNT,0 AS P_AMOUNT,
' ' AS CN,
' ' AS AN,
' ' AS BANK_CODE,
' ' AS VN 
FROM
MEMBER_FUND
UNION
SELECT
PF_RECEIVE_ID AS ID,
DESCRIPTION AS DES,
RECEIVE_DATE AS RDATE,
RECEIVED_AMOUNT AS MR_AMOUNT,0 AS P_AMOUNT,
CHECK_NO AS CN,
ACCOUNT_NO AS AN,
(SELECT LB.BANK_NAME FROM L_BANK LB WHERE BANK_CODE=LB.BANK_ID) AS BANK_CODE,
VOUCHER_NO AS VN 
FROM
PF_RECEIVE WHERE RECEIVE_DATE BETWEEN P_BEGIN_DATE AND P_END_DATE
GROUP BY
PF_RECEIVE_ID,DESCRIPTION,RECEIVE_DATE,RECEIVED_AMOUNT,CHECK_NO,ACCOUNT_NO,BANK_CODE,VOUCHER_NO
UNION
SELECT
PF_PAYMENT_ID AS ID,
DESCRIPTION DES,
PAYMENT_DATE AS RDATE,
0 AS MR_AMOUNT,PAYMENT_AMOUNT AS P_AMOUNT,
CHECK_NO AS CN,
ACCOUNT_NO AS AN,
(SELECT LB.BANK_NAME FROM L_BANK LB WHERE BANK_CODE=LB.BANK_ID) AS BANK_CODE,
VOUCHER_NO AS VN 
FROM
PF_PAYMENT WHERE PAYMENT_DATE BETWEEN P_BEGIN_DATE AND P_END_DATE
GROUP BY
PF_PAYMENT_ID,DESCRIPTION,PAYMENT_DATE,PAYMENT_AMOUNT,CHECK_NO,ACCOUNT_NO,BANK_CODE,VOUCHER_NO;
end RPT_PF_CASHBOOK;
/

--VARIABLE C REFCURSOR;
--EXEC RPT_PF_CASHBOOK(:C,'01-JUL-2005','30-JUN-2006');
--PRINT C;





--======== PF BANK STATEMENT ======
CREATE OR REPLACE PROCEDURE RPT_PF_BANK_ACCO_STATEMENT
(p_test_cursor in out
test_package.test_type,
P_BANK_CODE VARCHAR2,
P_ACCOUNT_TYPE VARCHAR2,
P_ACCOUNT_NO VARCHAR2,
P_BEGIN_DATE DATE,
P_END_DATE DATE
)
as
begin 
open p_test_cursor for  
SELECT 
0 AS ID,
P_BEGIN_DATE AS DDATE,
ACCOUNT_NO,
(SELECT TYPE_NAME FROM L_ACCOUNT_TYPE LAT WHERE ACCOUNT_TYPE=LAT.TYPE_ID) AS ACCOUNT_TYPE,
'OPENING BALANCE' AS DES,
AMOUNT AS O_AMOUNT,0 AS P_AMOUNT,
' ' AS PT,
(SELECT BANK_NAME FROM L_BANK LB WHERE BANK_CODE=LB.BANK_ID) AS BANK_CODE,
' ' AS CHECK_NO,
' ' AS VOUCHER_NO 
FROM 
MEMBER_FUND 
WHERE  
ACCOUNT_TYPE=P_ACCOUNT_TYPE 
AND ACCOUNT_NO=P_ACCOUNT_NO 
AND BANK_CODE=P_BANK_CODE 
UNION 
SELECT 
PF_RECEIVE_ID AS ID,
RECEIVE_DATE AS DDATE,
ACCOUNT_NO,
(SELECT TYPE_NAME FROM L_ACCOUNT_TYPE LAT WHERE ACCOUNT_TYPE=LAT.TYPE_ID) AS ACCOUNT_TYPE,
DESCRIPTION AS DES,
RECEIVED_AMOUNT AS O_AMOUNT,0 AS P_AMOUNT,
RECEIVE_TYPE AS PT,
(SELECT BANK_NAME FROM L_BANK LB WHERE BANK_CODE=LB.BANK_ID) AS BANK_CODE,
CHECK_NO,
VOUCHER_NO 
FROM PF_RECEIVE
WHERE 
ACCOUNT_TYPE=P_ACCOUNT_TYPE 
AND ACCOUNT_NO=P_ACCOUNT_NO 
AND BANK_CODE=P_BANK_CODE 
AND RECEIVE_DATE BETWEEN P_BEGIN_DATE AND P_END_DATE 
GROUP BY 
PF_RECEIVE_ID,RECEIVE_DATE,ACCOUNT_NO,ACCOUNT_TYPE,DESCRIPTION,RECEIVED_AMOUNT,RECEIVE_TYPE,BANK_CODE,CHECK_NO,VOUCHER_NO 

UNION
SELECT 
PF_PAYMENT_ID AS ID,
PAYMENT_DATE AS DDATE,
ACCOUNT_NO,
(SELECT TYPE_NAME FROM L_ACCOUNT_TYPE LAT WHERE ACCOUNT_TYPE=LAT.TYPE_ID) AS ACCOUNT_TYPE,
DESCRIPTION AS DES,
0 AS O_AMOUNT,PAYMENT_AMOUNT AS P_AMOUNT,
PAYMENT_TYPE AS PT,
(SELECT BANK_NAME FROM L_BANK LB WHERE BANK_CODE=LB.BANK_ID) AS BANK_CODE,
CHECK_NO,
VOUCHER_NO 
FROM PF_PAYMENT
WHERE 
ACCOUNT_TYPE=P_ACCOUNT_TYPE 
AND ACCOUNT_NO=P_ACCOUNT_NO 
AND BANK_CODE=P_BANK_CODE 
AND PAYMENT_DATE BETWEEN P_BEGIN_DATE AND P_END_DATE 
GROUP BY 
PF_PAYMENT_ID,PAYMENT_DATE,ACCOUNT_NO,ACCOUNT_TYPE,DESCRIPTION,PAYMENT_AMOUNT,PAYMENT_TYPE,BANK_CODE,CHECK_NO,VOUCHER_NO;
END RPT_PF_BANK_ACCO_STATEMENT;

/

--=========PF_BALANCE_SHEET

CREATE OR REPLACE PROCEDURE PF_BALANCE_SHEET 
(p_test_cursor in out
test_package.test_type,
P_BEGIN_DATE DATE,
P_END_DATE DATE
)
as
begin
open p_test_cursor for 

SELECT
AMOUNT AS M_AMOUNT,0 AS  RECEIVE_AMOUNT,0 AS PAYMENT_AMOUNT,0 AS ISSUED_LOAN_AMOUNT,0 AS LOAN_RE_AMOUNT
FROM
MEMBER_FUND
UNION
SELECT
0 AS M_MOUNT, RECEIVED_AMOUNT AS RECEIVE_AMOUNT, 0 AS PAYMENT_AMOUNT,0 AS ISSUED_LOAN_AMOUNT,0 AS LOAN_RE_AMOUNT
FROM
PF_RECEIVE
WHERE RECEIVE_DATE BETWEEN P_BEGIN_DATE AND P_END_DATE
UNION
SELECT
0 AS M_AMOUNT, 0 AS RECEIVE_AMOUNT,PAYMENT_AMOUNT AS PAYMENT_AMOUNT,0 AS ISSUED_LOAN_AMOUNT,0 AS LOAN_RE_AMOUNT
FROM
PF_PAYMENT
WHERE PAYMENT_DATE BETWEEN P_BEGIN_DATE AND P_END_DATE
UNION
SELECT
0 AS M_AMOUNT, 0 AS RECEIVE_AMOUNT,0 AS PAYMENT_AMOUNT,NOOFINSTALLMENT AS ISSUED_LOAN_AMOUNT,0 AS LOAN_RE_AMOUNT
FROM
LOANINFORMATION_MAIN
WHERE
LOANISSUEDATE BETWEEN P_BEGIN_DATE AND P_END_DATE
UNION
SELECT
0 AS M_AMOUNT, 0 AS RECEIVE_AMOUNT,0 AS PAYMENT_AMOUNT,0 AS ISSUED_LOAN_AMOUNT,AMOUNTPAID AS LOAN_RE_AMOUNT
FROM
LOANINFORMATION_SUB
WHERE
LOANREFUNDEDDATE BETWEEN P_BEGIN_DATE AND P_END_DATE;

end PF_BALANCE_SHEET;

/


--================================================================end












