CREATE OR REPLACE PROCEDURE WORD_INFO_SAVE
as
V_MAX_END_DATE DATE;
V_MAX_BEGIN_DATE  DATE;
V_PF_RECEIVE NUMBER;
V_PF_PAYMENT NUMBER;
V_MEMBER_FUND NUMBER;
V_TOTAL NUMBER;

begin

SELECT MAX(BEGIN_DATE) INTO V_MAX_BEGIN_DATE FROM FISCAL_YEAR_SETUP;

SELECT MAX(END_DATE) INTO V_MAX_END_DATE FROM FISCAL_YEAR_SETUP;

select DISTINCT 
SUM(PFR.RECEIVED_AMOUNT) INTO V_PF_RECEIVE from PF_RECEIVE PFR,FISCAL_YEAR_SETUP FYS,MEMBER_FUND MF
where PFR.ACCOUNT_TYPE=MF.ACCOUNT_TYPE AND PFR.BANK_CODE=MF.BANK_CODE
AND PFR.ACCOUNT_NO=MF.ACCOUNT_NO AND BEGIN_DATE=V_MAX_BEGIN_DATE AND END_DATE=V_MAX_END_DATE;

select DISTINCT SUM(PFP.PAYMENT_AMOUNT) INTO V_PF_PAYMENT from PF_PAYMENT PFP,FISCAL_YEAR_SETUP FYS,MEMBER_FUND MF
where PFP.ACCOUNT_TYPE=MF.ACCOUNT_TYPE AND PFP.BANK_CODE=MF.BANK_CODE
AND PFP.ACCOUNT_NO=MF.ACCOUNT_NO AND BEGIN_DATE=V_MAX_BEGIN_DATE AND END_DATE=V_MAX_END_DATE;

select DISTINCT SUM(MF.AMOUNT) INTO V_MEMBER_FUND from PF_RECEIVE PFR,FISCAL_YEAR_SETUP FYS,PF_PAYMENT PFP,MEMBER_FUND MF
where PFR.ACCOUNT_TYPE=PFP.ACCOUNT_TYPE AND PFR.ACCOUNT_TYPE=MF.ACCOUNT_TYPE
AND PFP.ACCOUNT_TYPE=MF.ACCOUNT_TYPE AND PFR.BANK_CODE=PFP.BANK_CODE
AND PFR.BANK_CODE=MF.BANK_CODE AND PFP.BANK_CODE=MF.BANK_CODE
AND PFR.ACCOUNT_NO=PFP.ACCOUNT_NO AND PFR.ACCOUNT_NO=MF.ACCOUNT_NO
AND PFP.ACCOUNT_NO=MF.ACCOUNT_NO AND BEGIN_DATE=V_MAX_BEGIN_DATE AND END_DATE=V_MAX_END_DATE;

V_TOTAL=(V_MEMBER_FUND)-(V_PF_PAYMENT);
V_TOTAL=(V_MEMBER_FUND)+(PFR.RECEIVED_AMOUNT);

END;
commit;
end  PROCEDURE WORD_INFO_SAVE;





CREATE OR REPLACE PROCEDURE UPDATE_MEMBER_FUND_ALL
(p_test_cursor in out
test_package.test_type)
as
V_BEGIN_DATE,
V_END_DATE,
V_BANK_CODE,
V_ACCOUNT_TYPE,
V_ACCOUNT_NO
begin 
open p_test_cursor for  

SELECT MAX(BEGIN_DATE) INTO V_MAX_BEGIN_DATE FROM FISCAL_YEAR_SETUP;

SELECT MAX(END_DATE) INTO V_MAX_END_DATE FROM FISCAL_YEAR_SETUP;







