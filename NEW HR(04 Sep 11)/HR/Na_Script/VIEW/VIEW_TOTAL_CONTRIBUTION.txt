CREATE OR REPLACE VIEW VIEW_TOTAL_CONTRIBUTION
AS
SELECT
EMP_PF.EMP_ID,
EMP_INFO.EMP_NM,
ST_DESIG.DESIGNATION,
ST_DEPT.DEPT_NM,
SUM(EMP_PF.EMPLOYER_CONTRIBUTION) AS TOTAL_OFFI_CON,
SUM(EMP_PF.EMPLOYEE_CONTRIBUTION) AS TOTAL_EMP_CON,
(SUM(EMP_PF.EMPLOYER_CONTRIBUTION)+SUM(EMP_PF.EMPLOYEE_CONTRIBUTION)) as TOTAL_CON 
from 
EMP_PF,
EMP_JOB_INFO,
ST_DEPT,
ST_DESIG,
EMP_INFO
where
EMP_PF.EMP_ID=EMP_INFO.EMP_ID
AND EMP_INFO.EMP_ID=EMP_JOB_INFO.EMP_ID
AND EMP_JOB_INFO.DEPT=ST_DEPT.DEPT_CODE
AND EMP_JOB_INFO.DESIG=ST_DESIG.DESIG_CODE
GROUP BY EMP_PF.EMP_ID,EMP_INFO.EMP_NM,ST_DESIG.DESIGNATION,ST_DEPT.DEPT_NM