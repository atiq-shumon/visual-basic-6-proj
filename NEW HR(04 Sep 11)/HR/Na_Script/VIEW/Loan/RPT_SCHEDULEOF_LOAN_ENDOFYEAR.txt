CREATE OR REPLACE  PROCEDURE RPT_SCHEDULEOF_LOAN_ENDOFYEAR
  (p_test_cursor in
    out
test_package.test_type,
P_BeginDate Date,
p_EndDate Date
)
as
begin
open p_test_cursor for
SELECT LOANINFORMATION_MAIN.EMP_ID,
LOANINFORMATION_MAIN.ISSUEDAMOUNT,
LOANINFORMATION_MAIN.NOOFINSTALLMENT,LOANINFORMATION_MAIN.SLABINSTALLMENTAMOUNT,
COUNT(LOANINFORMATION_SUB.AmountPaid) As TOTAL_PAID,
EMP_INFO.EMP_NM
From LOANINFORMATION_MAIN, LOANINFORMATION_SUB,EMP_INFO
Where (LOANINFORMATION_MAIN.EMP_ID = LOANINFORMATION_SUB.EMP_ID)
AND (LOANINFORMATION_MAIN.EMP_ID=EMP_INFO.EMP_ID)
AND (LOANINFORMATION_SUB.LOANREFUNDEDDATE BETWEEN P_BeginDate AND p_EndDate)
GROUP BY LOANINFORMATION_MAIN.EMP_ID,
LOANINFORMATION_MAIN.ISSUEDAMOUNT,
LOANINFORMATION_MAIN.NOOFINSTALLMENT,
LOANINFORMATION_MAIN.SlabInstallmentAmount,
EMP_INFO.EMP_NM;
end Rpt_Scheduleof_Loan_EndOfYear;