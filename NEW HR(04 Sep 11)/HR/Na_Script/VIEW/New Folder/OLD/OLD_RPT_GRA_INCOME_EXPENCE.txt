CREATE OR REPLACE  PROCEDURE RPT_GRA_INCOME_EXPENCE
(p_test_cursor in out
test_package.test_type,
P_BEGIN_DATE DATE,
P_END_DATE DATE
)
as
begin
open p_test_cursor for
select 
PAYMENT_RECE_DATE AS RD,
GRA_RECEIVE_ID as ID,
SOURCE_OF_GRATUITY AS SOG,' ' AS POP,
DESCRIPTION AS Rdes,' ' AS Pdes,
RECEIVED_AMOUNT AS Ramount,0 AS Pamount
from 
gratuity_receive 
WHERE PAYMENT_RECE_DATE BETWEEN P_BEGIN_DATE AND P_END_DATE
union 
select 
PAYMENT_DATE AS RD,
GRA_PAYMENT_ID as ID ,
' ' AS SOG, PURPOSE_OF_PAYMENT AS POP,
' ' AS Rdes,DESCRIPTION AS Pdes,
0 AS Ramount,AMOUNT AS Pamount
from 
gratuity_payment 
WHERE PAYMENT_DATE BETWEEN P_BEGIN_DATE AND P_END_DATE;
end RPT_GRA_INCOME_EXPENCE;
