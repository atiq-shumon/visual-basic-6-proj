--GRA RECEIVE SOURCE_OF_GRATUITY WISE

CREATE OR REPLACE  PROCEDURE RPT_GRA_REC_SOURCE_OF_GRATUITY
(p_test_cursor in out
test_package.test_type,
P_SOURCE_OF_GRATUITY VARCHAR2,
P_BEGIN_DATE DATE,
P_END_DATE DATE
)
as
begin
open p_test_cursor for 

SELECT
GRA_RECEIVE_ID,
(SELECT LS.SOURCE_NAME FROM L_SOURCE_OF_FUND LS WHERE SOURCE_OF_GRATUITY=LS.SOURCE_ID) AS SOURCE_OF_GRATUITY,
DESCRIPTION,
PAYMENT_RECE_DATE,
RECEIVED_AMOUNT,
PAYMENT_RECE_TYPE,
CHECK_NO,
ACCOUNT_NO,
(SELECT LB.BANK_NAME FROM L_BANK LB WHERE BANK_CODE=LB.BANK_ID) AS BANK_CODE,
VOUCHER_NO,
(SELECT LA.TYPE_NAME FROM L_ACCOUNT_TYPE LA WHERE ACCOUNT_TYPE=LA.TYPE_ID) AS ACCOUNT_TYPE
FROM
GRATUITY_RECEIVE
WHERE 
SOURCE_OF_GRATUITY=P_SOURCE_OF_GRATUITY 
AND PAYMENT_RECE_DATE BETWEEN P_BEGIN_DATE AND P_END_DATE;
END RPT_GRA_REC_SOURCE_OF_GRATUITY;
/





--GRA PAYMENT PURPOSE_OF_PAYMENT WISE

CREATE OR REPLACE  PROCEDURE RPT_GRA_PUR_OF_PAYMENT_WISE
(p_test_cursor in out
test_package.test_type,
P_PURPOSE_OF_PAYMENT VARCHAR2,
P_BEGIN_DATE DATE,
P_END_DATE DATE
)
as
begin
open p_test_cursor for 
SELECT 
GRA_PAYMENT_ID,
(SELECT LP.PURPOSE_NAME FROM L_GRA_PAYMENT_PURPOSE LP WHERE PURPOSE_OF_PAYMENT=LP.PURPOSE_ID) AS PURPOSE_OF_PAYMENT,
DESCRIPTION,
PAYMENT_DATE,
AMOUNT,
PAYMENT_TYPE,
CHECK_NO,
ACCOUNT_NO,
(SELECT LB.BANK_NAME FROM L_BANK LB WHERE BANK_CODE=LB.BANK_ID) AS BANK_CODE,
VOUCHER_NO,
(SELECT LA.TYPE_NAME FROM L_ACCOUNT_TYPE LA WHERE ACCOUNT_TYPE=LA.TYPE_ID) AS ACCOUNT_TYPE 
FROM 
GRATUITY_PAYMENT  
WHERE 
PURPOSE_OF_PAYMENT=P_PURPOSE_OF_PAYMENT 
AND PAYMENT_DATE BETWEEN P_BEGIN_DATE AND P_END_DATE;
END RPT_GRA_PUR_OF_PAYMENT_WISE; 

/



--RPT_GRA_REC_BANK_WISE

CREATE OR REPLACE  PROCEDURE RPT_GRA_REC_BANK_WISE
(p_test_cursor in out
test_package.test_type,
P_BANK_CODE VARCHAR2,
P_BEGIN_DATE DATE,
P_END_DATE DATE
)
as
begin
open p_test_cursor for
SELECT
GRA_RECEIVE_ID,
(SELECT LS.SOURCE_NAME FROM L_SOURCE_OF_FUND LS WHERE SOURCE_OF_GRATUITY=LS.SOURCE_ID) AS SOURCE_OF_GRATUITY,
DESCRIPTION,
PAYMENT_RECE_DATE,
RECEIVED_AMOUNT,
PAYMENT_RECE_TYPE,
CHECK_NO,
ACCOUNT_NO,
(SELECT LB.BANK_NAME FROM L_BANK LB WHERE BANK_CODE=LB.BANK_ID) AS BANK_CODE,
VOUCHER_NO,
(SELECT LA.TYPE_NAME FROM L_ACCOUNT_TYPE LA WHERE ACCOUNT_TYPE=LA.TYPE_ID) AS ACCOUNT_TYPE
FROM
GRATUITY_RECEIVE
WHERE
BANK_CODE=P_BANK_CODE
AND PAYMENT_RECE_DATE BETWEEN P_BEGIN_DATE AND P_END_DATE;
END RPT_GRA_REC_BANK_WISE;
/




--RPT_GRA_Payment_BANK_WISE

CREATE OR REPLACE  PROCEDURE RPT_GRA_Payment_BANK_WISE
(p_test_cursor in out
test_package.test_type,
P_BANK_CODE VARCHAR2,
P_BEGIN_DATE DATE,
P_END_DATE DATE
)
as
begin
open p_test_cursor for 
SELECT 
GRA_PAYMENT_ID,
(SELECT LP.PURPOSE_NAME FROM L_GRA_PAYMENT_PURPOSE LP WHERE PURPOSE_OF_PAYMENT=LP.PURPOSE_ID) AS PURPOSE_OF_PAYMENT,
DESCRIPTION,
PAYMENT_DATE,
AMOUNT,
PAYMENT_TYPE,
CHECK_NO,
ACCOUNT_NO,
(SELECT LB.BANK_NAME FROM L_BANK LB WHERE BANK_CODE=LB.BANK_ID) AS BANK_CODE,
VOUCHER_NO,
(SELECT LA.TYPE_NAME FROM L_ACCOUNT_TYPE LA WHERE ACCOUNT_TYPE=LA.TYPE_ID) AS ACCOUNT_TYPE 
FROM 
GRATUITY_PAYMENT  
WHERE 
BANK_CODE=P_BANK_CODE 
AND PAYMENT_DATE BETWEEN P_BEGIN_DATE AND P_END_DATE;
END RPT_GRA_Payment_BANK_WISE; 

/



