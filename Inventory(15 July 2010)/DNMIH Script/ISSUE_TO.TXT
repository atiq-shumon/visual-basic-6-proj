SELECT M.ISSUETYPE,(SELECT TYPE_NAME FROM ITEM_ISSUE_TYPE WHERE
 ITEM_ISSUE_TYPE.TYPE_CODE=M.ISSUETYPE) AS TYPE,SUM(B.ISSUED)
 FROM ISSUEMAIN M,(SELECT ISSUEID,SUM(URATE*QTY) AS ISSUED FROM ISSUESUB 
                   GROUP BY ISSUEID) B
WHERE TO_CHAR(M.ISSUEID)=TO_CHAR(B.ISSUEID)
  AND TO_DATE(TO_CHAR(ISSUEDATE,'DD-MON-RRRR'),'DD-MON-RRRR')
>=TO_DATE('01-JUL-2007','DD-MON-RRRR')
  AND UPPER(M.ISSUEID) LIKE UPPER('%I-01-%')
GROUP BY ROLLUP(M.ISSUETYPE)
/
