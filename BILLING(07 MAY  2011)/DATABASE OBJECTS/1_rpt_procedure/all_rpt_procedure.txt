CREATE OR REPLACE PROCEDURE RPT_SHIFTWISE_ADMISSION
(P_TEST_CURSOR IN OUT TEST_PACKAGE.TEST_TYPE, 
 p_date_spec IN DATE,
 p_shift_text IN VARCHAR2,
 P_YEAR_cODE VARCHAR2
)
AS
var_shift_start_time_hr NUMBER(2);
var_shift_end_time_hr NUMBER(2);
        
BEGIN
select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24'))
		 into 
                		var_shift_start_time_hr,
				var_shift_end_time_hr 
                 from shift_setup
        where upper(shift_name)=upper(p_shift_text) ;



		if var_shift_start_time_hr>var_shift_end_time_hr then   
                 OPEN P_TEST_CURSOR FOR    
		    select  A.IN_REG_NO ,B.PAT_NAME NAME,B.PAT_GUARD_NAME GUARDIAN,B.ADDR1 ADDRESS,A.BED_TYPE||'-'||A.BED_TYPE_NO||' ('|| A.BED_NO ||')'  BED,A.DOC_DEPT DEPARTMENT,
                       DECODE(A.MIGRATION_FLAG,1,'B*','') ADMISSION_OR_BED_TRANSFER,A.DT DT,To_Char(A.dt,'hh:mm:ss AM') time
                        FROM  INDOOR_PAT_BED_INFO A,IN_DOOR_PAT_INFO_MAIN B
			where (A.IN_REG_NO=B.IN_REG_NO AND A.YRCODE=B.YRCODE) AND (A.YRcODE=P_YEAR_cODE) AND
                         to_char(A.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') AND
                          to_number(to_char(A.dt,'HH24')) between var_shift_start_time_hr
                	and 23 
                     UNION
                        select  A.IN_REG_NO,B.PAT_NAME NAME,B.PAT_GUARD_NAME GUARDIAN,B.ADDR1 ADDRESS,A.BED_TYPE||'-'||A.BED_TYPE_NO||' ('|| A.BED_NO ||')'  BED,A.DOC_DEPT DEPARTMENT,
                       DECODE(A.MIGRATION_FLAG,1,'B*','') ADMISSION_OR_BED_TRANSFER ,A.DT DT,To_Char(A.dt,'hh:mm:ss AM') time
                       FROM  INDOOR_PAT_BED_INFO A,IN_DOOR_PAT_INFO_MAIN B
			where (A.IN_REG_NO=B.IN_REG_NO AND A.YRCODE=B.YRCODE) AND (A.YRcODE=P_YEAR_cODE) AND
                       to_char(A.dt,'dd-mon-yyyy')=to_char(p_date_spec+1,'dd-mon-yyyy') AND 
                          to_number(to_char(A.dt,'HH24')) between 0
                	and var_shift_end_time_hr;

               ELSE
                   OPEN P_TEST_CURSOR FOR  
                    select  A.IN_REG_NO,B.PAT_NAME NAME,B.PAT_GUARD_NAME GUARDIAN,B.ADDR1 ADDRESS,A.BED_TYPE||'-'||A.BED_TYPE_NO||' ('|| A.BED_NO ||')'  BED,A.DOC_DEPT DEPARTMENT,
                       DECODE(A.MIGRATION_FLAG,1,'B*','') ADMISSION_OR_BED_TRANSFER,A.DT DT,To_Char(A.dt,'hh:mm:ss AM') time 
                        FROM  INDOOR_PAT_BED_INFO A,IN_DOOR_PAT_INFO_MAIN B
			where (A.IN_REG_NO=B.IN_REG_NO AND A.YRCODE=B.YRCODE) AND (A.YRcODE=P_YEAR_cODE) AND
                          to_char(A.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') AND 
                          to_number(to_char(A.dt,'HH24')) between var_shift_start_time_hr
                	and var_shift_end_time_hr ;
              END IF;

END;











create or replace procedure Rpt_Diag_Income_Test_Head_Wise(p_test_cursor in out test_package.test_type,
                                                p_mode number,
                                                P_head varchar2,
                                                p_date1 date,
                                                p_date2 date)
as
begin
  if p_mode=1 then
     OPEN P_TEST_CURSOR FOR
       select sub_code ,(select s_name from test_info_sub  where
           m_code=p_head  and s_code=(sub_code) ) as s_name,
                Total,Amount, Discount
          from
      (SELECT O.s_code SUb_code,
           count(O.reg_no) Total,sum(O.test_charge) Amount
             from pat_info_sub1_out_door O
         where O.m_code=P_head
         and   (((to_char(O.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(O.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(O.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy')
                    and to_date(to_char(O.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(O.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(O.dt,'hh24'))  between 0 and 7)))

         group by O.s_code)  ,

         (SELECT sum(disc) Discount
          from pat_info_sub3_out_door
         where reg_no in (select distinct(P.reg_no)
             from pat_info_sub1_out_door  P
          where P.m_code=P_head
         and (((to_char(P.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(P.dt,'hh24'))
                between 8 and 23)) or (to_date(to_char(P.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                    > to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy')
                    and to_date(to_char(P.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(P.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(P.dt,'hh24'))  between 0 and 7)))));

END IF;

END;





create or replace procedure Rpt_Diag_Income_Test_Wise(p_test_cursor in out test_package.test_type,
                                                p_mode number,
                                                p_date1 date,
                                                p_date2 date)
as 
begin
  if p_mode=1 then
     OPEN P_TEST_CURSOR FOR
   select title,sum(reciept_number) "Receipt" ,sum(amount) Amount,sum(discount) Discount
      from
        (select decode(main_code,'01','Pathology','02',
             'Pathology','03','Pathology','04',
             'Pathology','05','Pathology','06','Pathology','10','Pathology',
             '08','Immunization','09','X-Ray','11','Physiotherapy','12','Ambulance',
             '13','Dental','14','Dressing','15','Ultrasonogram','16','Blood Transfusion',
             '17','Eye test','18','Minor Operation','19','Birth Certificate','20','ENT test',
              '0101','ECG','0102','ECG','0103','ECG','0104','ECG','0201','ECG',
              '0202','ECG','0203','ECG','0204','ECG',
               '0301','ETT','0302','ETT','0303','ETT','0304','ETT',
                '0401','Echo','0402','Echo','0403','Echo','0404','Echo','0501','Echo',
                '0502','Echo','0503','Echo','0504','Echo',
 'Others') title,
 count(receipt_no) reciept_number,sum(Total_amt) amount,sum(Total_disc) discount
   from
           (SELECT  B.REG_NO receipt_no,B.YRCODE,max(B.M_CODE) main_code,a.total_amt Total_amt,a.disc Total_disc
  		 FROM PAT_INFO_SUB1_OUT_DOOR B,PAT_INFO_SUB3_OUT_DOOR A
		 WHERE to_number(b.m_code)<>to_number('07') and
                 (((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy')
                    and to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))  between 0 and 7)))
           and (a.reg_no=b.reg_no AND B.YRCODE =A.YRCODE)
             group by b.reg_no,b.yrcode,a.total_amt,a.disc
            union
            SELECT  B.REG_NO receipt_no,B.YRCODE,max(B.S_CODE) main_code,a.total_amt Total_amt,a.disc Total_disc
  		 FROM PAT_INFO_SUB1_OUT_DOOR B,PAT_INFO_SUB3_OUT_DOOR A
		 WHERE to_number(b.m_code)=to_number('07') and                  (((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy')
                    and to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))  between 0 and 7)))

              and (a.reg_no=b.reg_no AND B.YRCODE =A.YRCODE)
             group by b.reg_no,b.yrcode,a.total_amt,a.disc
)
group by main_code)
group by title;
END IF; --END OF P_MODE=1

END;


create or replace procedure rptAdmission_Summary(p_test_cursor in out test_package.test_type,
                                                p_mode number,
                                                p_date1 date,
                                                p_date2 date)
as 
begin
  if p_mode=1 then
     open p_test_cursor for
        SELECT DOC_DEPT,SUM(ADMITTED)+SUM(CANCEL) total_admitted,SUM(CANCEL) TOTAL_ADM_CANCEL,SUM(CAB) cabin_pat,
           SUM(PAY) paying_pat,SUM(FREE) free_pat 
          FROM (select doc_dept,count(in_reg_no) ADMITTED,sum(decode(CANCELLATION_FLAG,1,1,0)) AS CANCEL,0 AS CAB,0 AS PAY,0 AS FREE
               from in_door_pat_info_main
              where (((to_char(dt,'dd-mon-yyyy') =to_char(p_date1,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')>
                  to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
    
      GROUP BY DOC_DEPT
         UNION
     SELECT DOC_DEPT,0 AS ADMITTED,0 AS CANCEL,SUM(DECODE(UPPER(BED_TYPE) ,UPPER('CABIN'),1,0)) AS CAB,SUM(DECODE(UPPER(BED_TYPE) ,UPPER('PAYING'),1,0)) AS PAY,SUM(DECODE(UPPER(BED_TYPE) ,UPPER('FREE-BED'),1,0)) AS FREE
        FROM indoor_pat_bed_info
      WHERE serial_no=1 
           and (((to_char(dt,'dd-mon-yyyy') =to_char(p_date1,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')>
                  to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
    
     GROUP BY DOC_DEPT)
GROUP BY DOC_DEPT;
end if;

end;



    










create or replace procedure Rptdiscount_info_receipt 
 	(p_test_cursor in out test_package.test_type,
        p_date1 date,
	p_date2 date)
AS
BEGIN       
---staff
delete from rpt_disc;
commit;
dbms_output.put_line(p_date1);
------hospital staff
insert into rpt_disc( 
		select '1','1',NVL(sum(DISC),0) from pat_info_sub3_out_door    where STAFF_POOR_PAT_DISC_FLAG=1 and 
(((to_char(dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')
<=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy')) 
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
 AND ( UPPER(EMP_ID) NOT LIKE UPPER('C%') AND UPPER(EMP_ID) NOT LIKE UPPER('M%')));
insert into rpt_disc(
		select '3', '1',NVL(sum(DISCOUNT),0) from indoor_pat_money  where  STAFF_POOR_PATIENT_FLAG=1 and  
(((to_char(dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')
<=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy')) 
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7))) AND  (UPPER(STAFF_ID) NOT LIKE UPPER('C%') AND   UPPER(STAFF_ID) NOT LIKE UPPER('M%')));
insert into rpt_disc VALUES(
		 '7','1', 0);

----college staff

insert into rpt_disc( 
		select '2','2',NVL(sum(DISC),0) from pat_info_sub3_out_door    where STAFF_POOR_PAT_DISC_FLAG=1 and (((to_char(dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')
<=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy')) 
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7))) AND UPPER(EMP_ID)  LIKE  UPPER('C%'));

insert into rpt_disc(
		select '4','2', NVL(sum(DISCOUNT),0) from indoor_pat_money  where  STAFF_POOR_PATIENT_FLAG=1 and  (((to_char(dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')
<=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy')) 
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
 AND  UPPER(STAFF_ID)  LIKE UPPER('C%'));

insert into rpt_disc VALUES(
		 '8','2', 0);

----committee member

insert into rpt_disc( 
		select '9','3',NVL(sum( DISC),0) from pat_info_sub3_out_door    where STAFF_POOR_PAT_DISC_FLAG=1 and (((to_char(dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')
<=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy')) 
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
 AND UPPER(EMP_ID)  LIKE  UPPER('m%'));

insert into rpt_disc(
		select '10','3', NVL(sum(DISCOUNT),0) from indoor_pat_money   where  STAFF_POOR_PATIENT_FLAG=1 and (((to_char(dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')
<=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy')) 
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
 AND  UPPER(STAFF_ID)  LIKE UPPER('m%'));

insert into rpt_disc VALUES('11','3', 0);


----poor patient

insert into rpt_disc(  ---diagnostic outdoor
		select '5','4', sum(DISC) from pat_info_sub3_out_door   where STAFF_POOR_PAT_DISC_FLAG=0 AND EMP_ID='0' and (((to_char(dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')
<=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy')) 
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7))) and in_reg_no=0
);


insert into rpt_disc(  ---diagnostic iNDOOR FREE BED
		select '12','5', sum(DISC) from pat_info_sub3_out_door   where STAFF_POOR_PAT_DISC_FLAG=0 AND EMP_ID='0' and (((to_char(dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')
<=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy')) 
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7))) and in_reg_no<>0
);

/*  ALL BED  DISCOUNT
insert into rpt_disc(
		select '6','4', NVL(sum(DISCOUNT),0) from indoor_pat_money  where  STAFF_POOR_PATIENT_FLAG=0 AND STAFF_ID='0' and  (((to_char(dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')
<=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy')) 
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
);

*/


insert into rpt_disc( --INDOOR PAT FREE BED
		select '6','5', sum(DISCOUNT) from indoor_pat_money M,INDOOR_PAT_BED_INFO B  where  M.STAFF_POOR_PATIENT_FLAG=0 AND M.STAFF_ID='0' and  (((to_char(M.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(M.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(M.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(M.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
<=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy')) 
	                    or ((to_char(M.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(M.dt,'hh24'))  between 0 and 7))) AND (M.IN_REG_NO=B.IN_REG_NO AND M.YRCODE=B.YRCODE 
     AND B.SERIAL_NO=(SELECT MAX(SERIAL_NO) FROM  INDOOR_PAT_BED_INFO WHERE IN_REG_NO=B.IN_REG_NO AND YRCODE=B.YRCODE AND UPPER(B.BED_TYPE)='FREE-BED')));


insert into rpt_disc( --CAB/WARD CHARGE DISCOUNT
		select '13','4', sum(DISCOUNT) from indoor_pat_money M,INDOOR_PAT_BED_INFO B  where  M.STAFF_POOR_PATIENT_FLAG=0 AND M.STAFF_ID='0' and  (((to_char(M.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(M.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(M.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(M.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
<=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy')) 
	                    or ((to_char(M.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(M.dt,'hh24'))  between 0 and 7))) AND (M.IN_REG_NO=B.IN_REG_NO AND M.YRCODE=B.YRCODE 
     AND B.SERIAL_NO=(SELECT MAX(SERIAL_NO) FROM  INDOOR_PAT_BED_INFO WHERE IN_REG_NO=B.IN_REG_NO AND YRCODE=B.YRCODE AND UPPER(B.BED_TYPE)<>'FREE-BED') AND UPPER(B.BED_TYPE) IN('CABIN','PAYING')));






open p_test_cursor for
      select * from rpt_disc ;

end;









CREATE OR REPLACE PROCEDURE ALL_DEPT_INCOME(P_TEST_CURSOR IN OUT TEST_PACKAGE.TEST_TYPE,
           P_DATE1 DATE,
           P_DATE2 DATE
)

 AS 
  BEGIN
    OPEN P_TEST_CURSOR FOR
      
SELECT DOC_DEPT ,SUM(admission_charge) AS ADM_CHARGE,SUM(bed_sum),SUM(operation_sum),SUM(service_charge),SUM(miscelleneous_charge),SUM(extra_bed_charge) 
,SUM(anesthesia_charge) ,SUM(delivery_charge),
       SUM(baby_care_charge),SUM(neunetal_bed_charge),SUM(Exchange_transfusion_charge) ,
       SUM(photo_therapy_charge),SUM(Blood_sugar_charge) ,SUM(medicine_charge),SUM(cardiology_charge) ,
      	SUM(Nebuliser_charge) ,SUM(incubator_charge) ,SUM(discount)
  FROM INDOOR_PAT_DEPT_INFO
WHERE RELEASE_FLAG=1 AND 
     (((to_char(dt,'dd-mon-yyyy') =to_char(p_date1,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')>
                  to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
                 GROUP BY DOC_DEPT;


END;








create or replace procedure all_depart_stat(p_test_cursor in out test_package.test_type,
P_DATE1 DATE,
P_DATE2 DATE)
AS
	BEGIN
		DELETE FROM RPT_STAT;
		COMMIT;
                INSERT INTO RPT_STAT(DEPT,ALL_PAT,MALE,FEMALE,ALL_PAT_CAB,ALL_PAT_PAY,ALL_PAT_FREE)
                 SELECT  A.DOC_DEPT,COUNT(A.IN_REG_NO),COUNT(DECODE(A.SEX,'M',1)),COUNT(DECODE(A.SEX,'F',1)),COUNT(DECODE(UPPER(B.BED_TYPE),'CABIN',1)),
                         COUNT(DECODE(UPPER(B.BED_TYPE),'PAYING',1)),COUNT(DECODE(UPPER(B.BED_TYPE),'FREE-BED',1))
                     FROM IN_DOOR_PAT_INFO_MAIN A,indoor_pat_bed_info B
                 WHERE (((to_char(A.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(A.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(A.dt,'dd-mon-yyyy'),'dd-mon-yyyy')>
                  to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(A.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(A.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(A.dt,'hh24'))  between 0 and 7))) AND A.RELEASE_FLAG<>4
                         
                     AND (A.IN_REG_NO=B.IN_REG_NO AND B.SERIAL_NO=1 AND A.YRCODE=B.YRCODE)
                          
                 GROUP BY A.DOC_DEPT;
                COMMIT;
                  UPDATE RPT_STAT 
                  SET OPR =(SELECT COUNT(A.OPERATION_SUM) 
                      FROM indoor_PAT_DEPT_info A
                   WHERE A.DOC_DEPT=RPT_STAT.DEPT AND A.RELEASE_FLAG=1 AND A.OPERATION_SUM>0 AND 
                    (((to_char(A.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(A.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(A.dt,'dd-mon-yyyy'),'dd-mon-yyyy')>
                  to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(A.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(A.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(A.dt,'hh24'))  between 0 and 7))));
                 UPDATE RPT_STAT 
                  SET  DELIVERY =(SELECT COUNT(A.DELIVERY_CHARGE) 
                      FROM indoor_PAT_DEPT_info A
                   WHERE A.DOC_DEPT=RPT_STAT.DEPT AND A.RELEASE_FLAG=1 AND A.DELIVERY_CHARGE>0 AND 
                      (((to_char(A.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(A.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(A.dt,'dd-mon-yyyy'),'dd-mon-yyyy')>
                  to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(A.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(A.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(A.dt,'hh24'))  between 0 and 7))));
                UPDATE RPT_STAT 
                  SET ADM_CANCEL =(SELECT COUNT(A.IN_REG_NO) 
                      FROM in_door_PAT_info_MAIN A
                   WHERE A.DOC_DEPT=RPT_STAT.DEPT AND A.RELEASE_FLAG=4 AND (((to_char(A.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(A.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(A.dt,'dd-mon-yyyy'),'dd-mon-yyyy')>
                  to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(A.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(A.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(A.dt,'hh24'))  between 0 and 7))));
OPEN P_TEST_CURSOR FOR
	SELECT * FROM RPT_STAT;
END ;
/










CREATE OR REPLACE PROCEDURE Rpt_diag_income_dept_Wise
    
    (             p_test_cursor in out test_package.test_type,
 		  p_mode  integer,
                  p_date1  date,
                  p_date2  date
     )

    as
      begin
          if p_mode=1 then  ---SUMMARY

            open p_test_cursor for
              select 1 as Indoor_outDoor_Indicator,a.doc_dept,count(A.REG_NO) AS REG_NO,

                   SUM(A.total_amt) AS test_charge,sum(A.disc)
                   from Pat_Info_Sub3_out_door A
               where   (((to_char(A.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(A.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(A.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy')
                    and to_date(to_char(A.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(A.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(A.dt,'hh24'))  between 0 and 7)))
                      AND a.in_reg_no=0 

             group by a.doc_dept

            union
                select 2 as Indoor_outDoor_Indicator,a.doc_dept,count(A.REG_NO) AS REG_NO,
                  SUM(A.total_amt) AS test_charge
                     ,sum(A.disc)
                   from Pat_Info_Sub3_out_door A
               where    (((to_char(A.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(A.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(A.dt,'dd-mon-yyyy'),'dd-mon-yyyy')>
                  to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(A.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(A.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(A.dt,'hh24'))  between 0 and 7)))
                      AND  a.in_reg_no<>0 

              group by a.doc_dept;
           END IF;


      if p_mode=2 then  ---DEPARTMENT WISE DETAILS

         OPEN P_TEST_CURSOR FOR
 
               SELECT 1 AS Indoor_outDoor_Indicator ,1 AS HEAD_INDICATOR ,A.doc_dept
                      ,Count(A.REG_NO) AS TOTAL_RECEIPT  , NVL(sum(A.TOTAL_AMT),0) AS CHARGE
                         ,NVL(sum(A.disc),0) AS DISCOUNT 
                               from pat_info_sub3_out_door A,(SELECT DISTINCT REG_NO,YRCODE FROM PAT_INFO_SUB1_OUT_DOOR B 
                       WHERE B.M_CODE IN('01','02','03','04','05','06','10') AND B.IN_REG_NO=0 
                            AND (((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')>
                  to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))  between 0 and 7)))    ) V
                WHERE A.REG_NO=V.REG_NO AND A.YRCODE=V.YRCODE

                  GROUP BY A.DOC_DEPT


                  
           UNION ALL
            SELECT 2 AS Indoor_outDoor_Indicator ,1 AS HEAD_INDICATOR ,A.doc_dept
                      ,Count(A.REG_NO) AS TOTAL_RECEIPT  , NVL(sum(A.TOTAL_AMT),0) AS CHARGE
                         ,NVL(sum(A.disc),0) AS DISCOUNT 
                               from pat_info_sub3_out_door A,(SELECT DISTINCT REG_NO,YRCODE FROM PAT_INFO_SUB1_OUT_DOOR B 
                       WHERE B.M_CODE IN('01','02','03','04','05','06','10') AND B.IN_REG_NO<>0 
                            AND (((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')>
                  to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))  between 0 and 7)))    ) V
                WHERE A.REG_NO=V.REG_NO AND A.YRCODE=V.YRCODE

                  GROUP BY A.DOC_DEPT 

        
      /* ECG  */


        UNION ALL
           SELECT 1 AS Indoor_outDoor_Indicator ,2 AS HEAD_INDICATOR ,A.doc_dept
                      ,Count(A.REG_NO) AS TOTAL_RECEIPT  , NVL(sum(A.TOTAL_AMT),0) AS CHARGE
                         ,NVL(sum(DISTINCT A.disc),0) AS DISCOUNT 
                               from pat_info_sub3_out_door A,(SELECT DISTINCT REG_NO,YRCODE FROM PAT_INFO_SUB1_OUT_DOOR B 
                       WHERE (((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')>
                  to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))  between 0 and 7))) 
                   AND  B.M_CODE IN('07') AND B.s_code in('0101','0102','0103','0104','0201','0202','0203','0204') AND B.IN_REG_NO=0 
                              ) V
                WHERE A.REG_NO=V.REG_NO AND A.YRCODE=V.YRCODE


             GROUP BY A.DOC_DEPT 

       UNION ALL
           SELECT 2 AS Indoor_outDoor_Indicator ,2 AS HEAD_INDICATOR ,A.doc_dept
                      ,Count(A.REG_NO) AS TOTAL_RECEIPT  , NVL(sum(A.TOTAL_AMT),0) AS CHARGE
                         ,NVL(sum(DISTINCT A.disc),0) AS DISCOUNT 
                               from pat_info_sub3_out_door A,(SELECT DISTINCT REG_NO,YRCODE FROM PAT_INFO_SUB1_OUT_DOOR B 
                       WHERE (((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')>
                  to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))  between 0 and 7))) 
                   AND  B.M_CODE IN('07') AND B.s_code in('0101','0102','0103','0104','0201','0202','0203','0204') AND B.IN_REG_NO<>0 
                              ) V
                WHERE A.REG_NO=V.REG_NO AND A.YRCODE=V.YRCODE


             GROUP BY A.DOC_DEPT 
      
 --ETT


        UNION ALL
           SELECT 1 AS Indoor_outDoor_Indicator ,3 AS HEAD_INDICATOR ,A.doc_dept
                      ,Count(A.REG_NO) AS TOTAL_RECEIPT  , NVL(sum(A.TOTAL_AMT),0) AS CHARGE
                         ,NVL(sum(DISTINCT A.disc),0) AS DISCOUNT 
                               from pat_info_sub3_out_door A,(SELECT DISTINCT REG_NO,YRCODE FROM PAT_INFO_SUB1_OUT_DOOR B 
                       WHERE (((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')>
                  to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))  between 0 and 7))) 
                   AND  B.M_CODE IN('07') AND B.s_code in('0301','0302','0303','0304') AND B.IN_REG_NO=0 
                              ) V
                WHERE A.REG_NO=V.REG_NO AND A.YRCODE=V.YRCODE


             GROUP BY A.DOC_DEPT 


       UNION ALL
           SELECT 2 AS Indoor_outDoor_Indicator ,3 AS HEAD_INDICATOR ,A.doc_dept
                      ,Count(A.REG_NO) AS TOTAL_RECEIPT  , NVL(sum(A.TOTAL_AMT),0) AS CHARGE
                         ,NVL(sum(DISTINCT A.disc),0) AS DISCOUNT 
                               from pat_info_sub3_out_door A,(SELECT DISTINCT REG_NO,YRCODE FROM PAT_INFO_SUB1_OUT_DOOR B 
                       WHERE (((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')>
                  to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))  between 0 and 7))) 
                   AND  B.M_CODE IN('07') AND B.s_code in('0301','0302','0303','0304') AND B.IN_REG_NO<>0 
                              ) V
                WHERE A.REG_NO=V.REG_NO AND A.YRCODE=V.YRCODE


             GROUP BY A.DOC_DEPT 


 ---ECHO


        UNION ALL
           SELECT 1 AS Indoor_outDoor_Indicator ,4 AS HEAD_INDICATOR ,A.doc_dept
                      ,Count(A.REG_NO) AS TOTAL_RECEIPT  , NVL(sum(A.TOTAL_AMT),0) AS CHARGE
                         ,NVL(sum(DISTINCT A.disc),0) AS DISCOUNT 
                               from pat_info_sub3_out_door A,(SELECT DISTINCT REG_NO,YRCODE FROM PAT_INFO_SUB1_OUT_DOOR B 
                       WHERE (((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')>
                  to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))  between 0 and 7))) 
                   AND  B.M_CODE IN('07') AND B.s_code in('0401','0402','0403','0404','0501','0502','0503','0504') AND B.IN_REG_NO=0 
                              ) V
                WHERE A.REG_NO=V.REG_NO AND A.YRCODE=V.YRCODE


             GROUP BY A.DOC_DEPT 

       UNION ALL
           SELECT 2 AS Indoor_outDoor_Indicator ,4 AS HEAD_INDICATOR ,A.doc_dept
                      ,Count(A.REG_NO) AS TOTAL_RECEIPT  , NVL(sum(A.TOTAL_AMT),0) AS CHARGE
                         ,NVL(sum(DISTINCT A.disc),0) AS DISCOUNT 
                               from pat_info_sub3_out_door A,(SELECT DISTINCT REG_NO,YRCODE FROM PAT_INFO_SUB1_OUT_DOOR B 
                       WHERE (((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')>
                  to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))  between 0 and 7))) 
                   AND  B.M_CODE IN('07') AND B.s_code in('0401','0402','0403','0404','0501','0502','0503','0504') AND B.IN_REG_NO<>0 
                              ) V
                WHERE A.REG_NO=V.REG_NO AND A.YRCODE=V.YRCODE


             GROUP BY A.DOC_DEPT ;
 
 
   END IF;

   END;


 /* others   
      
      UNION ALL
          SELECT 1 AS Indoor_outDoor_Indicator,DECODE(TO_NUMBER(V.M_CODE),
                                         TO_NUMBER('19'),5, /* Birht certificate */ 
                                         TO_NUMBER('18'),6, /* MINOR OPERATION */  
                                         TO_NUMBER('08'),7, /*Immunizartion Operation certificate */
 					 TO_NUMBER('13'),8, /* DENTAL */
					 TO_NUMBER('17'),9, /*EyE Operation certificate */  
                                         TO_NUMBER('11'),10, /*Physiotherapy Operation certificate */  
                                         TO_NUMBER('14'),11, /*Dressing Operation certificate */ 
                                         TO_NUMBER('12'),12, /*AmbulanceOperation certificate */ 
                                         TO_NUMBER('15'),13, /*Ultrasonogram certificate */ 
                                         TO_NUMBER('20'),14,  /*ENT TEST */
                                         TO_NUMBER('16'),15, /*BLOOD TRANSFUSION */  
                                         TO_NUMBER('09'),16 /*X-RAY OUTDOOR */  
                                          )  AS HEAD_INDICATOR ,A.doc_dept
                      ,Count(A.REG_NO) AS TOTAL_RECEIPT  , NVL(sum(A.TOTAL_AMT),0) AS CHARGE
                         ,NVL(sum(DISTINCT A.disc),0) AS DISCOUNT 
                               from pat_info_sub3_out_door A,(SELECT DISTINCT M_CODE,REG_NO,YRCODE FROM PAT_INFO_SUB1_OUT_DOOR B 
                       WHERE (((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')>
                  to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))  between 0 and 7))) 
                   AND  B.M_CODE IN(TO_NUMBER('19'),TO_NUMBER('18'),TO_NUMBER('08'),TO_NUMBER('13'), TO_NUMBER('17'),TO_NUMBER('11'),
            TO_NUMBER('14'),TO_NUMBER('12'),TO_NUMBER('15'),TO_NUMBER('20'),TO_NUMBER('16'),TO_NUMBER('09')) AND B.IN_REG_NO=0 
                              ) V
                WHERE A.REG_NO=V.REG_NO AND A.YRCODE=V.YRCODE


             GROUP BY A.DOC_DEPT 

   UNION ALL
          SELECT 2 AS Indoor_outDoor_Indicator,DECODE(TO_NUMBER(V.M_CODE),
                                         TO_NUMBER('19'),5, /* Birht certificate */ 
                                         TO_NUMBER('18'),6, /* MINOR OPERATION */  
                                         TO_NUMBER('08'),7, /*Immunizartion Operation certificate */
 					 TO_NUMBER('13'),8, /* DENTAL */
					 TO_NUMBER('17'),9, /*EyE Operation certificate */  
                                         TO_NUMBER('11'),10, /*Physiotherapy Operation certificate */  
                                         TO_NUMBER('14'),11, /*Dressing Operation certificate */ 
                                         TO_NUMBER('12'),12, /*AmbulanceOperation certificate */ 
                                         TO_NUMBER('15'),13, /*Ultrasonogram certificate */ 
                                         TO_NUMBER('20'),14,  /*ENT TEST */
                                         TO_NUMBER('16'),15, /*BLOOD TRANSFUSION */
                                         TO_NUMBER('09'),16 /*X-RAY INDOOR */   
                                          )  AS HEAD_INDICATOR ,A.doc_dept
                      ,Count(A.REG_NO) AS TOTAL_RECEIPT  , NVL(sum(A.TOTAL_AMT),0) AS CHARGE
                         ,NVL(sum(DISTINCT A.disc),0) AS DISCOUNT 
                               from pat_info_sub3_out_door A,(SELECT DISTINCT M_CODE,REG_NO,YRCODE FROM PAT_INFO_SUB1_OUT_DOOR B 
                       WHERE (((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date1
                      ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')>
                  to_date(to_char(p_date1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(B.dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                        <=to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(B.dt,'dd-mon-yyyy') =to_char(p_date2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(B.dt,'hh24'))  between 0 and 7))) 
                   AND  B.M_CODE IN(TO_NUMBER('19'),TO_NUMBER('18'),TO_NUMBER('08'),TO_NUMBER('13'), TO_NUMBER('17'),TO_NUMBER('11'),
            TO_NUMBER('14'),TO_NUMBER('12'),TO_NUMBER('15'),TO_NUMBER('20'),TO_NUMBER('16'),TO_NUMBER('09')) AND B.IN_REG_NO<>0 
                              ) V
                WHERE A.REG_NO=V.REG_NO AND A.YRCODE=V.YRCODE


             GROUP BY A.DOC_DEPT ;
     
      *\






























create or replace procedure Rpt_FLED_PAT
(p_test_cursor in out test_package.test_type,
			p_option number,
			p_date2 date,
			p_date3 date)
as
begin
if p_option=1 then
 open p_test_cursor for
   select
    p.in_reg_no ,
    p. BED_EXTRA_FLAG_PRINT,
    p.pat_name as "Patient Name",
    p.sex as Sex,
    p.age  as Age,
    p.religion as Religion,
    p.addr1 As Address,
    p.addr2,
    p.phone  as Phone,
    p.pat_guard_name ,
    p.doc_dept As "Doctors Department",
    p.dt  "Issue Date",
    p.check_name,
    b.BED_NO,b.BED_TYPE,
    b.BED_TYPE_no,
    p.admission_date,
    p.CANCELLATION_FLAG,
    B.ED_DT AS RELEASE_DATE,
    I.advance,
    i.total_operation_sum,
    i.admission_charge,
    i.bed_sum,
    i.discount ,
    i.miscelleneous_charge,
    i.extra_bed_charge ,
    i.anesthesia_charge,
    i.delivery_charge,
    i.pathology_charge,
     i.service_charge,
     i.neunetal_bed_charge,
    i.Exchange_transfusion_charge,
    i.photo_therapy_charge,
    i.blood_sugar_charge,
     i.medicine_charge,
    i.cardiology_charge,
    i.nebuliser_charge 

  from  INDOOR_PAT_MON_FLED I, 
     in_door_Pat_Info_Main p,
   indoor_pat_bed_info b
 where I.IN_REG_NO=P.IN_REG_NO AND I.in_reg_no=b.in_reg_no 
 and B.SERIAL_NO=(SELECT MAX(SERIAL_NO) FROM indoor_pat_bed_info WHERE IN_REG_NO=B.IN_REG_NO) AND (to_date(to_char(I.DT,'dd-mon-yyyy'),'dd-mon-yyyy')>= to_date(to_char(p_date2,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(I.DT,'dd-mon-yyyy'),'dd-mon-yyyy')<= to_date(to_char(p_date3,'dd-mon-yyyy'),'dd-mon-yyyy')) ;
   end if;
end;




--------------patient history

create or replace procedure Rpt_patient_history

(p_test_cursor in out test_package.test_type,
   p_option number,
   p_name varchar2,
   p_date1 date,
   p_dt1 date,
   p_dt2 date)
as
begin
if p_option=1 then
 open p_test_cursor for
 select
   p.in_reg_no ,
   p. BED_EXTRA_FLAG_PRINT,
   p.pat_name as "Patient Name",
   p.sex as Sex,
   p.age  as Age,
   p.religion as Religion,
   p.addr1 As Address,
   p.phone  as Phone,
   p.pat_guard_name ,
   p.doc_dept As "Doctors Department",
   p.dt  "Issue Date",
   p.check_name,
   b.BED_NO,b.BED_TYPE,
   b.BED_TYPE_no,
  b.admission_date,
  p.CANCELLATION_FLAG,
  p.release_date AS RELEASE_DATE
   from in_door_Pat_Info_Main p,
  indoor_pat_bed_info b
  where    p.in_reg_no=b.in_reg_no AND (P.YRCODE=B.YRCODE) and upper(p.pat_name) like concat(upper(p_name),'%');
 end if;
  if p_option=2 then
   open p_test_cursor for
     select distinct
    p.in_reg_no ,
    p. BED_EXTRA_FLAG_PRINT,
    p.pat_name as "Patient Name",
    p.sex as Sex,
    p.age  as Age,
    p.religion as Religion,
    p.addr1 As Address,
    p.phone  as Phone,
    p.pat_guard_name ,
    p.doc_dept As "Doctors Department",
    p.dt  "Issue Date",
    p.check_name,
    b.BED_NO,b.BED_TYPE,
    b.BED_TYPE_no,
    b.admission_date,
    p.CANCELLATION_FLAG,
    p.release_date AS RELEASE_DATE,
   b.serial_no as serial_no

  from in_door_Pat_Info_Main p,
   indoor_pat_bed_info b
 where    p.in_reg_no=b.in_reg_no AND (P.YRCODE=B.YRCODE) AND to_char(p.admission_date,'dd-mm-yyyy')=to_char(p_date1,'dd-mm-yyyy')  order by serial_no;

end if;
if p_option=3 then
 open p_test_cursor for
   select
    p.in_reg_no ,
    p. BED_EXTRA_FLAG_PRINT,
    p.pat_name as "Patient Name",
    p.sex as Sex,
    p.age  as Age,
    p.religion as Religion,
    p.addr1 As Address,
    p.phone  as Phone,
    p.pat_guard_name ,
    p.doc_dept As "Doctors Department",
    p.dt  "Issue Date",
    p.check_name,
    b.BED_NO,b.BED_TYPE,
    b.BED_TYPE_no,
   p.admission_date,
   p.CANCELLATION_FLAG,
   B.ed_DT AS RELEASE_DATE
  
  from in_door_Pat_Info_Main p,
   indoor_pat_bed_info b
 where    p.in_reg_no=b.in_reg_no AND (P.YRCODE=B.YRCODE) and 
    (((to_char(b.dt,'dd-mon-yyyy') =to_char(p_dt1
        ,'dd-mon-yyyy') and to_number(to_char(b.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(b.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(b.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy')) 
	                    or ((to_char(b.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(b.dt,'hh24'))  between 0 and 7))) ;
              

   end if;
   
end;







create or replace procedure Rptin_out_door_info_receipt 
 	(p_test_cursor in out test_package.test_type,
			p_index in  integer,
			p_text in  varchar2,
			p_dt1 in  date,p_dt2 in  date,
                        p_flag integer,
			p_date_spec date,
			p_shift_specific integer,
			p_shift_text varchar2)
    as
            var_shift_start_time_hr   number(10);
		var_shift_end_time_hr      number(10);
            var_shift_start_time_min  number(10);
		var_shift_end_time_min    number(10);  
            var_shift_start_time_sec   number(10);
		var_shift_end_time_sec   number(10);   
		var_shift_start_time varchar2(30);
		var_shift_end_time varchar2(30);
             VAR_SHIFT_END_TIME_NIGHT NUMBER(10);
             
begin
	delete from IN_OUT_RECEIPT_ALL;
		commit;
 if p_flag=0 then             ---means not enabled AND NOT DATE SPECIFIC
                  if p_index=1 and p_shift_specific=0  then --------all COLLECTION OF DATE  TO DATE
				insert into IN_OUT_RECEIPT_ALL(
					    select  
			      			b.reg_no,
							b.net_paid
						from pat_info_sub3_out_door b
					where (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                          <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy')) 
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7))));

				  insert into IN_OUT_RECEIPT_ALL( --------advance
		     				select  
			       	 		b.receipt_no,
					  		b.advance				
				    		    from advance b
						where  (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                          <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy')) 
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7))));


                       insert into in_out_receipt_all( -------diagnostic refund
                            	 select b.rec_no ,b.amount
                               	 from  diag_refund b
                                where (((to_char(REC_dAtE,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(REC_dAtE,'hh24'))   between 8 and 23)) or (to_date(to_char(REC_dAtE,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(REC_dAtE,'dd-mon-yyyy'),'dd-mon-yyyy')
                          <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy')) 
	                    or ((to_char(REC_dAtE,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(REC_dAtE,'hh24'))  between 0 and 7))));
    
 
		              insert into in_out_receipt_all( -------Others money
            	                	 select b.receipt_no ,b.amount
                  	             	 from  others_money b
                        	        where  (((to_char(REC_dAtE,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(REC_dAtE,'hh24'))   between 8 and 23)) or (to_date(to_char(REC_dAtE,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(REC_dAtE,'dd-mon-yyyy'),'dd-mon-yyyy')
                          <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy')) 
	                    or ((to_char(REC_dAtE,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(REC_dAtE,'hh24'))  between 0 and 7))));

			         insert into in_out_receipt_all( -------in_door_pat_money
            		                	 select b.pat_id ,b.net_total_charge
                        		       	 from  indoor_pat_money b
                                		where (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy') and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')
                          <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy')) 
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7))));
			         open p_test_cursor for select * from IN_OUT_RECEIPT_ALL order by RECEIPT_NO asc;
		END IF; --------End of all COLLECTION OF   DATE TO DATE 
     		if p_index=1 and p_shift_specific=1  then -------- DATE to date AND shift spcefic all
                			select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24')),
                				to_number(to_char(shift_start_time,'mi')),to_number(to_char(shift_end_time,'mi')),
	                			to_number(to_char(shift_start_time,'ss')),to_number(to_char(shift_end_time,'ss'))
		 		into 
                				var_shift_start_time_hr,
						var_shift_end_time_hr ,
                				var_shift_start_time_min,
						var_shift_end_time_min,  
                				var_shift_start_time_sec,
						var_shift_end_time_sec     
               			from shift_setup
	 		     where shift_name=p_shift_text ;
	     if var_shift_start_time_hr>var_shift_end_time_hr then       
			 	insert into IN_OUT_RECEIPT_ALL(
			     			select  
                              		DISTINCT(b.reg_no),
							b.net_paid
						from pat_info_sub3_out_door b,shift_setup c
							where b.dt between p_dt1 and p_dt2 and
      	           		 c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
         				and 23 );
 				insert into IN_OUT_RECEIPT_ALL( ---rest part of night
			     			select  
                              		DISTINCT(b.reg_no),
							b.net_paid
						from pat_info_sub3_out_door b,shift_setup c
							where b.dt between p_dt1 and p_dt2 and
      	           		 c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between 0 and  var_shift_end_time_hr );


               		 insert into IN_OUT_RECEIPT_ALL(-------advance
				 		select  
			        				b.receipt_no,
				  				b.advance
						from advance b,shift_setup c
						where b.dt between p_dt1 and p_dt2 and 
                         			c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
         						and 23 );
 				insert into IN_OUT_RECEIPT_ALL(-------rest part of night
				 		select  
			        				b.receipt_no,
				  				b.advance
						from advance b,shift_setup c
						where b.dt between p_dt1 and p_dt2 and 
                         			c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between 0
         						and var_shift_end_time_hr );

                   		insert into in_out_receipt_all(
                              		 select b.pat_id ,b.net_total_charge
                               		 from  indoor_pat_money b,shift_setup c
                               where b.dt between p_dt1 and p_dt2 and 
                         			c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
         						and 23); 
				insert into in_out_receipt_all(
                              		 select b.pat_id ,b.net_total_charge
                               		 from  indoor_pat_money b,shift_setup c
                               where b.dt between p_dt1 and p_dt2 and 
                         			c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between 0
         						and var_shift_start_time_hr); 
				insert into in_out_receipt_all( -------Others money
                            	 select b.receipt_no ,b.amount
                               	 from  others_money b
                                where b.rec_date between  p_dt1 and p_dt2 and to_number(to_char(b.rec_date,'hh24')) not between 0 and var_shift_end_time_night);  
   						-------------rest part of night
  				insert into in_out_receipt_all( -------Others money
                            	 select b.receipt_no ,b.amount
                               	 from  others_money b
                                where  b.rec_date between  p_dt1 and p_dt2 and to_number(to_char(b.rec_date,'hh24'))  between 0 and var_shift_end_time_night);  





                         open p_test_cursor for select * from IN_OUT_RECEIPT_ALL order by RECEIPT_NO asc;
             ELSE
                     insert into IN_OUT_RECEIPT_ALL( 
		     		 		select  
			      			b.reg_no,
							b.net_paid
						from pat_info_sub3_out_door b,shift_setup c
							where dt between p_dt1 and p_dt2 and 
     								c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       							and var_shift_end_time_hr )  ;
       			insert into IN_OUT_RECEIPT_ALL( ------ADVANCE
		     						select  
			        					receipt_no,
				  					advance				
								from advance b,shift_setup c
								where dt between p_dt1 and p_dt2 and 
     									c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
      							 and var_shift_end_time_hr  )  ;

                        insert into in_out_receipt_all( ----INDOOR PAT MONEY
                              		 select pat_id ,net_total_charge
                               		 from  indoor_pat_money b,shift_setup c
                                       		where dt between p_dt1 and p_dt2 and 
     								c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
      							and var_shift_end_time_hr  )  ;

			

				insert into in_out_receipt_all( -------Others money
                            	 select b.receipt_no ,b.amount
                               	 from  others_money b
                                where b.rec_date between  p_dt1 and p_dt2 and to_number(to_char(b.rec_date,'hh24'))  between var_shift_start_time_hr
 and var_shift_end_time_night);  
   				


        				open p_test_cursor for select * from IN_OUT_RECEIPT_ALL order by RECEIPT_NO asc;
                  			 END IF;
	end if; ---------------------------end of shift specific
  /*if p_index=5 and p_shift_specific=1  then --------user and DATE to date AND shift spcefic 
	select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24')),
                to_number(to_char(shift_start_time,'mi')),to_number(to_char(shift_end_time,'mi')),
                to_number(to_char(shift_start_time,'ss')),to_number(to_char(shift_end_time,'ss'))
		 into 
            		    var_shift_start_time_hr,
					var_shift_end_time_hr ,
                			var_shift_start_time_min,
					var_shift_end_time_min,  
 		              	 var_shift_start_time_sec,
					var_shift_end_time_sec     
                from shift_setup
				where upper(shift_name)=upper(p_shift_text) ;
		if var_shift_start_time_hr>var_shift_end_time_hr then       
				 insert into IN_OUT_RECEIPT_ALL(
				 select  
				      	distinct(b.reg_no),
					b.net_paid
				from pat_info_sub3_out_door b
				where b.dt between p_dt1 and p_dt2 and
					b.u_id=p_text and 
                               to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
	and 23 ) ;

		 					insert into in_out_receipt_all(
                              		 select pat_id ,net_total_charge
                               		 from  others_money b,shift_setup c
                                       		where dt between p_dt1 and p_dt2 and 
     								c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between 0
      							and var_shift_end_time_hr  )  ;


                         --------------------rest part of night
                     insert into IN_OUT_RECEIPT_ALL(
				 select  
				      	distinct(b.reg_no),
					b.net_paid
				from pat_info_sub3_out_door b
				where b.dt between p_dt1 and p_dt2 and
					b.u_id=p_text and 
                        to_number(to_char(b.dt,'HH24')) between 0 and var_shift_end_time_hr); 
 			insert into IN_OUT_RECEIPT_ALL( --------advance
		     			select  
			       	 	distinct(b.receipt_no),
				  		b.advance				
					from advance b
				where b.dt between p_dt1 and p_dt2 and
				 b.u_id=p_text and 
                               to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
	and 23 or  to_number(to_char(b.dt,'HH24')) between 0 and var_shift_end_time_hr); 
	    insert into in_out_receipt_all( -------in_door_pat_money
                              select distinct(b.pat_id) ,b.net_total_charge
                               	 from  indoor_pat_money b
                               where b.dt between p_dt1 and p_dt2 and
					 b.u_id=p_text and 
                              to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
		and 23 or  to_number(to_char(b.dt,'HH24')) between 0 and var_shift_end_time_hr );
           open p_test_cursor for select * from IN_OUT_RECEIPT_ALL order by RECEIPT_NO asc;
                   ELSE
                     insert into IN_OUT_RECEIPT_ALL(
				 select  
			      	distinct(b.reg_no),
					b.net_paid
				from pat_info_sub3_out_door b
				where b.dt between p_dt1 and p_dt2 and  b.u_id=p_text 
                                 and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr );   
 				insert into IN_OUT_RECEIPT_ALL( --------advance
		     			select  
			       	 	distinct(b.receipt_no),
				  		b.advance				
					from advance b
				where b.dt between p_dt1 and p_dt2  and b.u_id=p_text 
                                and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr ); 
       		insert into in_out_receipt_all( -------in_door_pat_money
                            	 select distinct(b.pat_id) ,b.net_total_charge
                               	 from  indoor_pat_money b
            where b.dt between p_dt1 and p_dt2  and b.u_id=p_text 
                               and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr );
                           open p_test_cursor for select * from IN_OUT_RECEIPT_ALL order by RECEIPT_NO asc;
                     END IF;
     end if;*/
else

                                      --------all COLLECTION OF A  DATE 
   		 select to_number(to_char(shift_end_time,'HH24')) into VAR_SHIFT_END_TIME_NIGHT from shift_setup where upper(shift_name)=upper('night');
			          if p_index=1 and p_shift_specific=0  then --------all COLLECTION OF A  DATE 
						insert into IN_OUT_RECEIPT_ALL(
						 select  
						      	b.reg_no,
								b.net_paid
							from pat_info_sub3_out_door b
					where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and to_number(to_char(b.dt,'hh24')) not between 0 and VAR_SHIFT_END_TIME_NIGHT);
-----------------------------------------------------                 next part of night
                	      insert into IN_OUT_RECEIPT_ALL(
				 select  
			      	b.reg_no,
					b.net_paid
				from pat_info_sub3_out_door b
			where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec+1,'dd-mon-yyyy')
                       AND TO_NUMBER(to_char(b.dt,'HH24')) BETWEEN 0 AND VAR_SHIFT_END_TIME_NIGHT);
			insert into IN_OUT_RECEIPT_ALL( --------advance
		     			select  
			       	 	b.receipt_no,
				  		b.advance				
					from advance b
			where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and to_number(to_char(b.dt,'hh24')) not between 0 and var_shift_end_time_night); 
-----------------------------------------------------                 next part of night
              insert into IN_OUT_RECEIPT_ALL( --------advance
		     			select  
			       	 	b.receipt_no,
				  		b.advance				
					from advance b
			where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec+1,'dd-mon-yyyy')
                  AND TO_NUMBER(to_char(b.dt,'HH24'))BETWEEN 0 AND VAR_SHIFT_END_TIME_NIGHT);

               insert into in_out_receipt_all( -------Others money
                            	 select b.receipt_no ,b.amount
                               	 from  others_money b
                                where to_char(b.rec_date,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy')and to_number(to_char(b.rec_date,'hh24')) not between 0 and var_shift_end_time_night);  
   						-------------rest part of night
  		insert into in_out_receipt_all( -------Others money
                            	 select b.receipt_no ,b.amount
                               	 from  others_money b
                                where to_char(b.rec_date,'dd-mon-yyyy')=to_char(p_date_spec+1,'dd-mon-yyyy')and to_number(to_char(b.rec_date,'hh24'))  between 0 and var_shift_end_time_night);  
         


         insert into in_out_receipt_all( -------diagnostic refund
                            	 select b.rec_no ,b.amount
                               	 from diag_refund b
                                where to_char(b.rec_date,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy')and to_number(to_char(b.rec_date,'hh24')) not between 0 and var_shift_end_time_night);  
   						-------------rest part of night
  		insert into in_out_receipt_all( -------diagnostic refund
                            	 select b.rec_no ,b.amount
                               	 from  diag_refund b
                                where to_char(b.rec_date,'dd-mon-yyyy')=to_char(p_date_spec+1,'dd-mon-yyyy')and to_number(to_char(b.rec_date,'hh24'))  between 0 and var_shift_end_time_night);  


         insert into in_out_receipt_all( -------in_door_pat_money
                            	 select b.pat_id ,b.net_total_charge
                               	 from  indoor_pat_money b
                       where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and to_number(to_char(b.dt,'hh24')) not between 0 and var_shift_end_time_night);
-----------------------------------------------------                 next part of night
         insert into in_out_receipt_all( -------in_door_pat_money
                            	 select b.pat_id ,b.net_total_charge
                               	 from  indoor_pat_money b
                                where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec+1,'dd-mon-yyyy')
                          AND TO_NUMBER(to_char(b.dt,'HH24'))BETWEEN 0 AND VAR_SHIFT_END_TIME_NIGHT);


			         open p_test_cursor for select * from IN_OUT_RECEIPT_ALL order by RECEIPT_NO asc;
    END IF;


	if p_index=1 and p_shift_specific=1  then -------- DATE AND shift spcefic all
			  select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24')),
		               to_number(to_char(shift_start_time,'mi')),to_number(to_char(shift_end_time,'mi')),
	                to_number(to_char(shift_start_time,'ss')),to_number(to_char(shift_end_time,'ss'))
		 into 
                		var_shift_start_time_hr,
				var_shift_end_time_hr ,
                		var_shift_start_time_min,
				var_shift_end_time_min,  
               		 var_shift_start_time_sec,
				var_shift_end_time_sec     
                from shift_setup
				where upper(shift_name)=upper(p_shift_text) ;
		if var_shift_start_time_hr>var_shift_end_time_hr then       
			insert into IN_OUT_RECEIPT_ALL(
				 select  
			      	b.reg_no,
					b.net_paid
				from pat_info_sub3_out_door b
			where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') AND
                          to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
	and 23 );
------------------------------------------------------rest part of night
               insert into IN_OUT_RECEIPT_ALL(
				 select  
			      	b.reg_no,
					b.net_paid
				from pat_info_sub3_out_door b
			where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec+1 ,'dd-mon-yyyy') AND
                      to_number(to_char(b.dt,'HH24')) between 0 and var_shift_end_time_hr);
			insert into IN_OUT_RECEIPT_ALL( --------advance
		     			select  
			       	 	b.receipt_no,
				  		b.advance				
					from advance b
			where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') AND
                          to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
	and 23);
     ----------rest par of night
           insert into IN_OUT_RECEIPT_ALL( --------advance
		     			select  
			       	 	b.receipt_no,
				  		b.advance				
					from advance b
			where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec+1,'dd-mon-yyyy') AND 
              to_number(to_char(b.dt,'HH24')) between 0 and var_shift_end_time_hr); 
         insert into in_out_receipt_all( -------in_door_pat_money
                            	 select b.pat_id ,b.net_total_charge
                               	 from  indoor_pat_money b
                                where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') AND
                        	  to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
					and 23 );
    --------------rest part of night
              insert into in_out_receipt_all( -------in_door_pat_money
                            	 select b.pat_id ,b.net_total_charge
                               	 from  indoor_pat_money b
                                where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec+1,'dd-mon-yyyy') AND
                        	  to_number(to_char(b.dt,'HH24')) between 	
               0 and var_shift_end_time_hr);

			insert into in_out_receipt_all( -------Others money
                            	 select b.receipt_no ,b.amount
                               	 from  others_money b
                                where to_char(b.rec_date ,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and to_number(to_char(b.rec_date,'hh24'))  between var_shift_start_time_hr AND
 23);  
   						-------------rest part of night
  				insert into in_out_receipt_all( -------Others money
                            	 select b.receipt_no ,b.amount
                               	 from  others_money b
                                where  to_char(b.rec_date ,'dd-mon-yyyy')=to_char(p_date_spec+1,'dd-mon-yyyy') and to_number(to_char(b.rec_date,'hh24'))  between 0 and var_shift_end_time_night);  

    insert into in_out_receipt_all( -------diag_refund
                            	 select b.rec_no ,b.amount
                               	 from  diag_refund b
                                where to_char(b.rec_date ,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and to_number(to_char(b.rec_date,'hh24'))  between var_shift_start_time_hr AND
 23);  
   						-------------rest part of night
  				insert into in_out_receipt_all( -------diag_refund
                            	 select b.rec_no ,b.amount
                               	 from  diag_refund b
                                where  to_char(b.rec_date ,'dd-mon-yyyy')=to_char(p_date_spec+1,'dd-mon-yyyy') and to_number(to_char(b.rec_date,'hh24'))  between 0 and var_shift_end_time_night);  



			         open p_test_cursor for select * from IN_OUT_RECEIPT_ALL order by RECEIPT_NO asc;
  		ELSE
                    insert into IN_OUT_RECEIPT_ALL(
				 select  
			      	b.reg_no,
					b.net_paid
				from pat_info_sub3_out_door b
			where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') AND
                          to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr );
			insert into IN_OUT_RECEIPT_ALL( --------advance
		     			select  
			       	 	b.receipt_no,
				  		b.advance				
					from advance b
			where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') AND
                         to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr ); 
       insert into in_out_receipt_all( -------in_door_pat_money
                            	 select b.pat_id ,b.net_total_charge
                               	 from  indoor_pat_money b
           where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') AND
                          to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr);
		insert into in_out_receipt_all( -------Others money
                            	 select b.receipt_no ,b.amount
                               	 from  others_money b
                                where to_char(b.rec_date ,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and to_number(to_char(b.rec_date,'hh24'))  between  var_shift_start_time_hr
	 and var_shift_end_time_hr); 
         insert into in_out_receipt_all( -------diag refund
                            	 select b.rec_no ,b.amount
                               	 from  diag_refund b
                                where to_char(b.rec_date ,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and to_number(to_char(b.rec_date,'hh24'))  between  var_shift_start_time_hr
	 and var_shift_end_time_hr);  
  
   			
                             open p_test_cursor for select * from IN_OUT_RECEIPT_ALL order by RECEIPT_NO asc;
                   END IF;
	end if;
if p_index=2 and p_shift_specific=0  then -------- DATE AND shift_spcefic 
 		 select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24')),
                to_number(to_char(shift_start_time,'mi')),to_number(to_char(shift_end_time,'mi')),
                to_number(to_char(shift_start_time,'ss')),to_number(to_char(shift_end_time,'ss'))
		 into 
                var_shift_start_time_hr,
		var_shift_end_time_hr ,
                var_shift_start_time_min,
		var_shift_end_time_min,  
                var_shift_start_time_sec,
		var_shift_end_time_sec     
                from shift_setup
				where upper(shift_name)=upper(p_text) ;
		if var_shift_start_time_hr>var_shift_end_time_hr then       
                     insert into IN_OUT_RECEIPT_ALL(
				 select  
			      	distinct(b.reg_no),
					b.net_paid
				from pat_info_sub3_out_door b
				where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy')   
                               and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
	and 23);
           ---------------rest part of night
                insert into IN_OUT_RECEIPT_ALL(
				 select  
			      	distinct(b.reg_no),
					b.net_paid
				from pat_info_sub3_out_door b
				where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec+1,'dd-mon-yyyy')  
                 and  to_number(to_char(b.dt,'HH24')) between 0 and var_shift_end_time_hr);
           	insert  into IN_OUT_RECEIPT_ALL( --------advance
		     			select  
			       	 	distinct(b.receipt_no),
				  		b.advance				
					from advance b
				where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy')
		       and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr

	and 23);
---------------------rest part of night 
         	insert  into IN_OUT_RECEIPT_ALL( --------advance
		     			select  
			       	 	distinct(b.receipt_no),
				  		b.advance				
					from advance b
				where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec+1,'dd-mon-yyyy')
				                         and to_number(to_char(b.dt,'HH24')) between 0 and var_shift_end_time_hr );
                       insert into in_out_receipt_all( -------in_door_pat_money
                            	 select distinct(b.pat_id) ,b.net_total_charge
                               	 from  indoor_pat_money b
                               where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy')
				AND 
                               to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
	and 23);              ------REST PART OF NIGHT
             insert into in_out_receipt_all( -------in_door_pat_money
                            	 select distinct(b.pat_id) ,b.net_total_charge
                               	 from  indoor_pat_money b
                               where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec+1,'dd-mon-yyyy')
				               and  to_number(to_char(b.dt,'HH24')) between 0 and var_shift_end_time_hr); 
				Insert into in_out_receipt_all( -------Others money
                            	 select b.receipt_no ,b.amount
                               	 from  others_money b
                                where to_char(b.rec_date ,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and to_number(to_char(b.rec_date,'hh24'))  between var_shift_start_time_hr
 And 23);  
   						-------------rest part of night
  				insert into in_out_receipt_all( -------Others money
                            	 select b.receipt_no ,b.amount
                               	 from  others_money b
                                where  to_char(b.rec_date ,'dd-mon-yyyy')=to_char(p_date_spec+1,'dd-mon-yyyy') and to_number(to_char(b.rec_date,'hh24'))  between 0 and var_shift_end_time_night);  



                                 open p_test_cursor for select * from IN_OUT_RECEIPT_ALL order by RECEIPT_NO asc;
                   ELSE
                       insert into IN_OUT_RECEIPT_ALL(
				 select  
			      	distinct(b.reg_no),
					b.net_paid
				from pat_info_sub3_out_door b
				where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy')  and
				                    to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr);   
                insert  into IN_OUT_RECEIPT_ALL( --------advance
		     			select  
			       	 	distinct(b.receipt_no),
				  		b.advance				
					from advance b
				where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy')  and
                                 to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       			and var_shift_end_time_hr  );
               insert into in_out_receipt_all( -------in_door_pat_money
                            	 select distinct(b.pat_id) ,b.net_total_charge
                               	 from  indoor_pat_money b
                   where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and
                                to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       			and var_shift_end_time_hr);
		insert into in_out_receipt_all( -------Others money
                            	 select b.receipt_no ,b.amount
                               	 from  others_money b
                                where to_char(b.rec_date ,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and to_number(to_char(b.rec_date,'hh24'))  between var_shift_start_time_hr
 and var_shift_end_time_night);  
 			
			         open p_test_cursor for select * from IN_OUT_RECEIPT_ALL order by RECEIPT_NO asc;
                     END IF;
end if;
 	-------DATE,SHIFT AND USER SPECIFIC

       if p_index=5 and p_shift_specific=1  then -------- DATE AND shift spcefic user
 		 select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24')),
                		to_number(to_char(shift_start_time,'mi')),to_number(to_char(shift_end_time,'mi')),
		                to_number(to_char(shift_start_time,'ss')),to_number(to_char(shift_end_time,'ss'))
		 into 
                		var_shift_start_time_hr,
				var_shift_end_time_hr ,
		                var_shift_start_time_min,
				var_shift_end_time_min,  
		                var_shift_start_time_sec,
				var_shift_end_time_sec     
                from shift_setup
				where upper(shift_name)=upper(p_shift_text) ;

		if var_shift_start_time_hr>var_shift_end_time_hr then       
                     		insert into IN_OUT_RECEIPT_ALL(
						 select  
						      	distinct(b.reg_no),
							b.net_paid
						from pat_info_sub3_out_door b
					where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and 
						upper(b.u_id)=upper(p_text)  
		                      and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
					and 23);
           ---------------rest part of night
		                insert into IN_OUT_RECEIPT_ALL(
						 select  
						      	distinct(b.reg_no),
							b.net_paid
						from pat_info_sub3_out_door b
					where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec+1,'dd-mon-yyyy') and 
				upper(b.u_id)=upper(p_text) 
	                 and  to_number(to_char(b.dt,'HH24')) between 0 and var_shift_end_time_hr);
	           	insert  into IN_OUT_RECEIPT_ALL( --------advance
		     			select  
			       	 	distinct(b.receipt_no),
				  		b.advance				
					from advance b
				where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy')
				and upper(b.u_id)=upper(p_text)  
                               and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
	and 23);
---------------------rest part of night 
         	insert  into IN_OUT_RECEIPT_ALL( --------advance
		     			select  
			       	 	distinct(b.receipt_no),
				  		b.advance				
					from advance b
				where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec+1,'dd-mon-yyyy')
				and upper(b.u_id)=upper(p_text) 
                         and to_number(to_char(b.dt,'HH24')) between 0 and var_shift_end_time_hr );


              insert into in_out_receipt_all( -------Others money
                            	 select b.receipt_no ,b.amount
                               	 from  others_money b
                                where  upper(b.u_id)=upper(p_text) AND  to_char(b.rec_date,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy')and to_number(to_char(b.rec_date,'hh24'))  between  var_shift_START_time_hr  and 23 );  
   						-------------rest part of night
 			 insert into in_out_receipt_all( -------Others money -------REST PART OF NIGHT
                            	 select b.receipt_no ,b.amount
                               	 from  others_money b
                                where  upper(b.u_id)=upper(p_text) AND  
			to_char(b.rec_date,'dd-mon-yyyy')=to_char(p_date_spec+1,'dd-mon-yyyy')and to_number(to_char(b.rec_date,'hh24'))  between 0 and var_shift_end_time_hr );  


         insert into in_out_receipt_all( -------diag discount
                            	 select b.rec_no ,b.amount
                               	 from  diag_refund b
                                where  upper(b.u_id)=upper(p_text) AND  to_char(b.rec_date,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy')and to_number(to_char(b.rec_date,'hh24'))  between  var_shift_START_time_hr  and 23 );  
   						-------------rest part of night
 			 insert into in_out_receipt_all( --------diag discount -------REST PART OF NIGHT
                            	 select b.rec_no ,b.amount
                               	 from  diag_refund b
                                where  upper(b.u_id)=upper(p_text) AND  
			to_char(b.rec_date,'dd-mon-yyyy')=to_char(p_date_spec+1,'dd-mon-yyyy')and to_number(to_char(b.rec_date,'hh24'))  between 0 and var_shift_end_time_hr );  


                       insert into in_out_receipt_all( -------in_door_pat_money
                            	 select distinct(b.pat_id) ,b.net_total_charge
                               	 from  indoor_pat_money b
                               where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy')
				and b.u_id=p_text AND 
                               to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
	and 23);
             insert into in_out_receipt_all( -------in_door_pat_money
                            	 select distinct(b.pat_id) ,b.net_total_charge
                               	 from  indoor_pat_money b
                               where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec+1,'dd-mon-yyyy')
				and b.u_id=p_text 
               and  to_number(to_char(b.dt,'HH24')) between 0 and var_shift_end_time_hr); 
                                 open p_test_cursor for select * from IN_OUT_RECEIPT_ALL order by RECEIPT_NO asc;
              ELSE
                       insert into IN_OUT_RECEIPT_ALL(
				 select  
			      	distinct(b.reg_no),
					b.net_paid
				from pat_info_sub3_out_door b
				where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy')  and
				 upper(b.u_id)=upper(p_text)  AND 
                   to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr);   
                insert  into IN_OUT_RECEIPT_ALL( --------advance
		     			select  
			       	 	distinct(b.receipt_no),
				  		b.advance				
					from advance b
				where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy')  and
				b.u_id=p_text  AND 
                                 to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       			and var_shift_end_time_hr  );

		   	 insert into in_out_receipt_all( -------Others money                             	
				 select b.receipt_no ,b.amount
                               	 from  others_money b
                                where  upper(b.u_id)=upper(p_text) AND  
			to_char(b.rec_date,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy')and to_number(to_char(b.rec_date,'hh24'))  between var_shift_start_time_hr
 and var_shift_end_time_hr);  

 insert into in_out_receipt_all( -------diag_discount                  	
				 select b.rec_no ,b.amount
                               	 from  diag_refund b
                                where  upper(b.u_id)=upper(p_text) AND  
			to_char(b.rec_date,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy')and to_number(to_char(b.rec_date,'hh24'))  between var_shift_start_time_hr
 and var_shift_end_time_hr);  


               insert into in_out_receipt_all( -------in_door_pat_money
                            	 select distinct(b.pat_id) ,b.net_total_charge
                               	 from  indoor_pat_money b
                   where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and
				b.u_id=p_text  AND 
                                to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       			and var_shift_end_time_hr);
			         open p_test_cursor for select * from IN_OUT_RECEIPT_ALL order by RECEIPT_NO asc;
                     END IF;
		end if;
  
end if;
end  Rptin_out_door_info_receipt
;


-----------RptINdoor_Admission_door_info_print----------------

create or replace procedure Rpt_in_dr_info_adm_print(p_test_cursor in out test_package.test_type,P_RECEIPT_NO NUMBER)
as
begin
 open p_test_cursor for
 select
   p.in_reg_no ,
   B.ext_flag_for_print AS BED_EXTRA_FLAG_PRINT,
   m.receipt_no ,-----receipt no
   p.pat_name as "Patient Name",
   p.sex as Sex,
   p.age  as Age,
   p.religion as Religion,
   p.addr1 As Address,
   p.Y_M_D,
   p.phone  as Phone,
   p.pat_guard_name ,
   M.DEPARTMENT As "Doctors Department",
   (SELECT F_NAME||M_NAME||' '||L_NAME
       FROM DOCTOR_INFO
   WHERE DOC_DEPT=M.DEPARTMENT) "DEPT. HEAD" ,
   P.ADMISSION_DATE "Issue Date",
   M.dt  "collection Date",
   p.check_name,
   b.BED_NO,b.BED_TYPE,
   b.Bed_type_no AS Bed_ext_col ,
   m.advance,
 (select user_name from security where user_id=m.u_id ) as "User Name"
from in_door_Pat_Info_Main p,
INDOOR_PAT_BED_INFO b ,advance m
where   (p.in_reg_no=m.in_reg_no AND P.YRCODE=M.YRCODE) 
     and (M.in_reg_no=b.in_reg_no AND  P.YRCODE=B.YRCODE
      AND M.BED_SERIAL_NO=B.SERIAL_NO) AND  m.receipt_no=P_RECEIPT_NO;
end;



----------------------------duplicate copy for showing----------------------
create or replace procedure Rpt_in_dr_info_adm_print(p_test_cursor in out test_package.test_type)
as
begin
 open p_test_cursor for
 select 
 		p.in_reg_no ,
 		p. BED_EXTRA_FLAG_PRINT,
 		m.receipt_no ,-----receipt no
 		p.pat_name as "Patient Name",
 		p.sex as Sex,
 		p.age  as Age,
 		p.religion as Religion,
 		p.addr1 As Address,
 		p.addr2,
 		p.phone  as Phone,
 		p.pat_guard_name ,
 		p.doc_dept As "Doctors Department",
 		p.dt  "Issue Date",
 		p.check_name,
 		b.BED_NO,b.BED_TYPE,
 		b.Bed_ext_col ,
 		m.advance,
 (select user_name from security where user_id=m.u_id ) as "User Name"
from in_door_Pat_Info_Main p,
bed_info b ,advance m
where   p.in_reg_no=m.in_reg_no and p.in_reg_no=b.in_reg_no
 and m.receipt_no=(select max(receipt_no) from advance) and b.TEMP_SERIAL_NO=(select max(TEMP_SERIAL_NO) from bed_info where in_reg_no=b.in_reg_no)
;
end;
---and p.in_reg_no=(select max(in_reg_no) from in_door_Pat_Info_Main) and
--------------Test_package

create or replace package Test_package
as type test_type is  ref cursor;

end Test_package;

-----------------------Rptothers Money
create or replace procedure Rpt_Others_money(p_test_cursor in out test_package.test_type,p_receipt_no number)
as
begin
 open p_test_cursor for
 select receipt_no, 
      name ,
      Address, 
      description,  
      amount,    
      (select user_name from security where user_id=u_id), 
      booth,
      dept,  
      serial_no,  
      rec_date
  from others_money
 where receipt_no=p_receipt_no;
end ;

------------------------------------------------
create or replace procedure Rpt_diag_refund(p_test_cursor in out test_package.test_type,p_rec_no number)
as
begin
 open p_test_cursor for
 select rec_no, 
      name ,
       description,  
      amount,    
      (select user_name from security where user_id=u_id), 
      booth,
      dept,  
      serial_no,  
      rec_date
  from diag_refund
 where rec_no=p_rec_no;
end ;








----------------procedure Rpt_test_main

create or replace procedure Rpt_test_main(p_test_cursor in out
test_package.test_type,
p_index integer,
p_m_code varchar2)
as
--p_m_code varchar2(2);
begin

--select m_code into  p_m_code  from
--test_info_main
--where m_name=p_m_name;


if p_index=1 then
open p_test_cursor for
  select m_code "Main Code",
 (select m_name from test_info_main
  where m_code=p_m_code) as main_name,
  s_code "Sub Code",
  s_name||'-------- '||' ( '||DECODE(SUBSTR(S_CODE,3,2),'01','CABIN','02','PAYING','03','OPD/FREE','04', 'OUT-CASE','OPD')||' )'  "Sub Name",
  type    "Type",
  charge  "Charge",
 service_charge "Service Charge"
from test_info_sub order by s_code;
 end if;
if p_index=2 then
open p_test_cursor for
  select m_code "Main Code",
 (select m_name from test_info_main
  where m_code=p_m_code) as Main_Name,
  s_code "Sub Code",
 s_name||'-------- '||' ( '||DECODE(SUBSTR(S_CODE,3,2),'01','CABIN','02','PAYING','03','OPD/FREE','04', 'OUT-CASE','OPD')||' )'  "Sub Name",
  type    "Type",
  charge  "Charge",
  service_charge "Service Charge"
	from test_info_sub  
where  m_code=p_m_code order by s_code;
end if;
end Rpt_test_main;


-----------Rptout_door_info_print----------------

create or replace procedure Rptout_door_info_print(p_test_cursor in out test_package.test_type,p_mode integer,P_RECEIPT_NO NUMBER)
as
begin

  if p_mode=1 then
	 open p_test_cursor for
		 select 
		 p.reg_no,
		 p.pat_name as "Patient Name",
 		 p.sex as Sex,
 		 p.age  as Age,S.EMP_ID AS STAFF,
 		 p.religion as Religion,
 		 p.addr1 As Address,
 		 p.doc_dept As "Doctors Department",
 		 p.dt  "Issue Date",
 		 (select user_name from security where user_id=p.u_id) as "User Name",
 		 (SELECT s_name FROM Test_Info_SUB WHERE TO_NUMBER(m_code)=TO_NUMBER(t.m_code) AND TO_NUMBER(S_code)=TO_NUMBER(t.S_code))  AS s_NAME ,
		 t.test_charge as "Charge",
		 t.service_charge,s.total_amt as "Total Amount",
		 s.disc  as "Discount", 
		 s.net_paid "Net Paid",
		 s.staff_poor_pat_disc_flag as "staff/poor_pat",P.Y_M_D 
	  from Pat_Info_Main_out_door_oltp p,
		Pat_Info_Sub3_out_door_oltp s ,
		pat_info_sub1_out_door_oltp t
		where p.reg_no=s.reg_no and  p.reg_no=t.reg_no
		and p.reg_no=P_RECEIPT_NO;

 elsif p_mode=2 then

   open p_test_cursor for
		 select 
		 p.reg_no,
		 p.pat_name as "Patient Name",
 		 p.sex as Sex,
 		 p.age  as Age,S.EMP_ID AS STAFF,
 		 p.religion as Religion,
 		 p.addr1 As Address,
 		 p.doc_dept As "Doctors Department",
 		 p.dt  "Issue Date",
 		 (select user_name from security where user_id=p.u_id) as "User Name",
 		 (SELECT s_name FROM Test_Info_SUB WHERE TO_NUMBER(m_code)=TO_NUMBER(t.m_code) AND TO_NUMBER(S_code)=TO_NUMBER(t.S_code))  AS s_NAME ,
		 t.test_charge as "Charge",
		 t.service_charge,s.total_amt as "Total Amount",
		 s.disc  as "Discount", 
		 s.net_paid "Net Paid",
		 s.staff_poor_pat_disc_flag as "staff/poor_pat",P.Y_M_D 
	  from Pat_Info_Main_out_door p,
		Pat_Info_Sub3_out_door s ,
		pat_info_sub1_out_door t
		where p.reg_no=s.reg_no and  p.reg_no=t.reg_no
		and p.reg_no=P_RECEIPT_NO;


end if; 
end Rptout_door_info_print;
--------------------------------------------------------Rptout_door_info_print_indoor

create or replace procedure Rptout_door_info_print_indoor(p_test_cursor in out test_package.test_type,P_MODE INTEGER,P_RECEIPT_NO NUMBER)
as
begin

 IF P_MODE=1 THEN
	 open p_test_cursor for
		  select  p.reg_no, p.in_reg_no, p.DOC_DEPT,
		  (select bed_type||'-( '||bed_type_no||' )-'||bed_no from indoor_pat_bed_info where in_reg_no=p.in_reg_no AND YRCODE=S.YRCODE  and serial_no=(select
		  max(serial_no) from indoor_pat_bed_info where in_reg_no=p.in_reg_no AND YRCODE=S.YRCODE )) as "Bed", 
		 p.pat_name as "Patient Name",
		 p.sex as Sex,
		 p.age  as Age,P.Y_M_D AS Y_M_D,	
		 p.religion as Religion,
		 p.addr1 As Address,
		 p.dt  "Issue Date",
		 (select user_name from security where user_id=p.u_id) as "User Name",
		 (SELECT s_name FROM Test_Info_SUB WHERE TO_NUMBER(m_code)=TO_NUMBER(t.m_code) AND TO_NUMBER(S_code)=TO_NUMBER(t.S_code))  AS s_NAME ,
		t.test_charge as "Charge",
		t.service_charge,s.total_amt as "Total Amount",
		s.disc  as "Discount",
		s.net_paid "Net Paid",
		s.staff_poor_pat_disc_flag as "staff/poor_pat",S.emp_id AS STAFF_ID
		from Pat_Info_Main_out_door_OLTP p,
		Pat_Info_Sub3_out_door_OLTP s ,
		pat_info_sub1_out_door_OLTP t
		where p.reg_no=s.reg_no and  p.reg_no=t.reg_no
		and p.reg_no=P_RECEIPT_NO;


	ELSIF P_MODE=2 THEN
             open p_test_cursor for
		  select  p.reg_no, p.in_reg_no, p.DOC_DEPT,
		  (select bed_type||'-( '||bed_type_no||' )-'||bed_no from indoor_pat_bed_info where in_reg_no=p.in_reg_no AND YRCODE=S.YRCODE  and serial_no=(select
		  max(serial_no) from indoor_pat_bed_info where in_reg_no=p.in_reg_no AND YRCODE=S.YRCODE )) as "Bed", 
		 p.pat_name as "Patient Name",
		 p.sex as Sex,
		 p.age  as Age,P.Y_M_D AS Y_M_D,	
		 p.religion as Religion,
		 p.addr1 As Address,
		 p.dt  "Issue Date",
		 (select user_name from security where user_id=p.u_id) as "User Name",
		 (SELECT s_name FROM Test_Info_SUB WHERE TO_NUMBER(m_code)=TO_NUMBER(t.m_code) AND TO_NUMBER(S_code)=TO_NUMBER(t.S_code))  AS s_NAME ,
		t.test_charge as "Charge",
		t.service_charge,s.total_amt as "Total Amount",
		s.disc  as "Discount",
		s.net_paid "Net Paid",
		s.staff_poor_pat_disc_flag as "staff/poor_pat",S.emp_id AS STAFF_ID
		from Pat_Info_Main_out_door p,
		Pat_Info_Sub3_out_door s ,
		pat_info_sub1_out_door t
		where p.reg_no=s.reg_no and  p.reg_no=t.reg_no
		and p.reg_no=P_RECEIPT_NO;
	END IF;
	end Rptout_door_info_print_indoor;




---------------------procedure Rptdoc_info

create or replace procedure Rptdoc_info(p_test_cursor in out test_package.test_type,
p_index integer,
p_doc_dept varchar2
)
as
begin
if p_index=1 then 
open p_test_cursor for
select refer_code  "Refer Code" ,
f_name,m_name,l_name, 
degree
as Degree ,
Doc_dept as Department,
addr as Address,
phone as Phone ,
fax as Fax,
email as "E-mail",
birth_date as "Birth Date",
marriage_status as "Martial Status"
from doctor_info order by position;
end if;
if p_index=2 then
open p_test_cursor for
select refer_code  "Refer Code" ,f_name,m_name,l_name	
,
degree
as Degree ,
Doc_dept as Department,
addr as Address,
phone as Phone ,
fax as Fax,
email as "E-mail",
birth_date as "Birth Date",
marriage_status as "Martial Status"
from doctor_info
where doc_dept=p_doc_dept order by position;
end if;
--end p_test_cursor;*/
end Rptdoc_info;


------------------procedure Rpt_test_main

create or replace procedure Rpt_test_main(p_test_cursor in out test_package.test_type,
p_bed_no varchar2)
as
begin
open p_test_cursor for
select
 bed_type as "Bed Type",
 seat_capacity "Seat Capacity",
 
 bed_no  "Bed No",
  bed_charge  "Charge"
from test_info_sub;
end Rpt_doc;


---------------------Rptout_door_info---------------------

create or replace procedure Rptout_door_info(p_test_cursor in out test_package.test_type,
(p_test_cursor in out test_package.test_type,
	p_index in  integer,
	p_text in  varchar2,
	p_dt1 in  date,p_dt2 in  date,
	p_flag integer,
	p_date_spec date,
	p_shift_specific integer,
	p_shift_text varchar2)
    as
                var_shift_start_time_hr   number(10);
		var_shift_end_time_hr      number(10);
                var_shift_start_time_min  number(10);
		var_shift_end_time_min    number(10);  
                var_shift_start_time_sec   number(10);
		var_shift_end_time_sec   number(10);   
		var_shift_start_time varchar2(30);
		var_shift_end_time varchar2(30);
begin
if p_flag=0 then  ---means not enabled AND NOT DATE SPECIFIC
     	if p_index=1 and p_shift_specific=0  then --------all   
		open p_test_cursor for
			select  a.m_code,a.m_name,
			a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
		        a.service_charge,  
		        b.total_amt,
			b.disc,
			b.net_paid
			from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b
			where a.dt between p_dt1 and p_dt2 and a.reg_no=b.reg_no  ;
	  END IF;
  if p_index=1 and p_shift_specific=1  then -------- DATE AND shift spcefic all
                select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24')),
                to_number(to_char(shift_start_time,'mi')),to_number(to_char(shift_end_time,'mi')),
                to_number(to_char(shift_start_time,'ss')),to_number(to_char(shift_end_time,'ss'))
		 into 
                var_shift_start_time_hr,
		var_shift_end_time_hr ,
                var_shift_start_time_min,
		var_shift_end_time_min,  
                var_shift_start_time_sec,
		var_shift_end_time_sec     
                from shift_setup
				where shift_name=p_shift_text ;
		if var_shift_start_time_hr>var_shift_end_time_hr then       
			 open p_test_cursor for
				 select  a.m_code,a.m_name,
				 a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
			        a.service_charge,  
			        b.total_amt,
				b.disc,
				b.net_paid
			from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b,shift_setup c
			where a.dt between p_dt1 and p_dt2 and a.reg_no=b.reg_no AND
                         c.shift_name=p_shift_text and to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
         		and 23 or  to_number(to_char(a.dt,'HH24')) between 0 and var_shift_end_time_hr ;
          ELSE
                      open p_test_cursor for
		     select  a.m_code,a.m_name,
		     a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
			        a.service_charge,  
			        b.total_amt,
				b.disc,
				b.net_paid
			from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b,shift_setup c
			where a.dt between p_dt1 and p_dt2 and a.reg_no=b.reg_no AND
     c.shift_name=p_shift_text and to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr ;   
                   END IF;
	end if;
if p_index=2 then --------shift
   select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24')),
                to_number(to_char(shift_start_time,'mi')),to_number(to_char(shift_end_time,'mi')),
                to_number(to_char(shift_start_time,'ss')),to_number(to_char(shift_end_time,'ss'))
		 into 
                var_shift_start_time_hr,
		var_shift_end_time_hr ,
                var_shift_start_time_min,
		var_shift_end_time_min,  
                var_shift_start_time_sec,
		var_shift_end_time_sec     
                from shift_setup
				where shift_name=p_shift_text ;
if var_shift_start_time_hr>var_shift_end_time_hr then
		  open p_test_cursor for
				select  a.m_code,a.m_name,
				a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
                                a.service_charge, 
			        b.total_amt,
				b.disc,
				b.net_paid
from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b
,shift_setup c
where a.dt between p_dt1 and p_dt2 and a.reg_no=b.reg_no
and  c.shift_name=p_shift_text and to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
         		and 23 or  to_number(to_char(a.dt,'HH24')) between 0 and var_shift_end_time_hr;            
else
		  open p_test_cursor for
				select  a.m_code,a.m_name,
				a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
                                a.service_charge,
			        b.total_amt,
				b.disc,
				b.net_paid
from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b
,shift_setup c
where a.dt between p_dt1 and p_dt2 and a.reg_no=b.reg_no
and c.shift_name=p_shift_text and to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr;   
end if;
end if;
if p_index=3 and p_shift_specific=0   then -----------on test_head
open p_test_cursor for
select  a.m_code,a.m_name,
a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
        a.service_charge,
        b.total_amt,
	b.disc,
	b.net_paid
from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b
where a.dt between p_dt1 and p_dt2 and a.reg_no=b.reg_no
and a.m_name=p_text and a.reg_no=b.reg_no ;
end if;
if p_index=3 and p_shift_specific=1  then -------- DATE AND shift spcefic on test head
  select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24')),
                to_number(to_char(shift_start_time,'mi')),to_number(to_char(shift_end_time,'mi')),
                to_number(to_char(shift_start_time,'ss')),to_number(to_char(shift_end_time,'ss'))
		 into 
                var_shift_start_time_hr,
		var_shift_end_time_hr ,
                var_shift_start_time_min,
		var_shift_end_time_min,  
                var_shift_start_time_sec,
		var_shift_end_time_sec     
                from shift_setup
				where shift_name=p_shift_text ;
		if var_shift_start_time_hr>var_shift_end_time_hr then  
                       open p_test_cursor for
				select  a.m_code,a.m_name,
				a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
				        a.service_charge,
				        b.total_amt,
					b.disc,
					b.net_paid
					from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b,SHIFT_SETUP C
					where a.dt between p_dt1 and p_dt2 and a.reg_no=b.reg_no
					and a.m_name=p_text and a.reg_no=b.reg_no
		                                        AND
                		         c.shift_name=p_shift_text and to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
	and 23 or  to_number(to_char(a.dt,'HH24')) between 0 and var_shift_end_time_hr;
                ELSE
                            open p_test_cursor for
				select  a.m_code,a.m_name,
				a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
				        a.service_charge,
				        b.total_amt,
					b.disc,
					b.net_paid
					from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b,SHIFT_SETUP C
					where a.dt between p_dt1 and p_dt2 and a.reg_no=b.reg_no
					and a.m_name=p_text and a.reg_no=b.reg_no
		                                        AND
                		         c.shift_name=p_shift_text and to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr ;  
                          END IF;
  END IF;                     
if p_index=4 and p_shift_specific=0  then -----------on doc_department
open p_test_cursor for
select  a.m_code,a.m_name,
a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
        a.service_charge,
        b.total_amt,
	b.disc,
	b.net_paid
from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b
where a.dt between p_dt1 and p_dt2 and a.reg_no=b.reg_no
and a.doc_dept=p_text and a.reg_no=b.reg_no ;
end if;
if p_index=4 and p_shift_specific=1  then -------- DATE AND shift spcefic ON DOCTOR DEPARTMENT
	  select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24')),
                to_number(to_char(shift_start_time,'mi')),to_number(to_char(shift_end_time,'mi')),
                to_number(to_char(shift_start_time,'ss')),to_number(to_char(shift_end_time,'ss'))
		 into 
                var_shift_start_time_hr,
		var_shift_end_time_hr ,
                var_shift_start_time_min,
		var_shift_end_time_min,  
                var_shift_start_time_sec,
		var_shift_end_time_sec     
                from shift_setup
				where shift_name=p_shift_text ;
		if var_shift_start_time_hr>var_shift_end_time_hr then  
       open p_test_cursor for
                     select  a.m_code,a.m_name,
			a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
		        a.service_charge,
		        b.total_amt,
			b.disc,
			b.net_paid
			from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b ,SHIFT_SETUP C
			where a.dt between p_dt1 and p_dt2 and a.reg_no=b.reg_no
			and a.doc_dept=p_text and a.reg_no=b.reg_no  AND		                                     
                        c.shift_name=p_shift_text and to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
	and 23 or  to_number(to_char(a.dt,'HH24')) between 0 and var_shift_end_time_hr and
         to_number(to_char(a.dt,'mi')) between  var_shift_start_time_min and var_shift_end_time_min
         and to_number(to_char(a.dt,'ss')) between var_shift_start_time_sec and var_shift_end_time_sec; 
 			ELSE
                   open p_test_cursor for 
                        select  a.m_code,a.m_name,
			a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
		        a.service_charge,
		        b.total_amt,
			b.disc,
			b.net_paid
			from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b ,SHIFT_SETUP C
			where a.dt between p_dt1 and p_dt2 and a.reg_no=b.reg_no
			and a.doc_dept=p_text and a.reg_no=b.reg_no  AND		                                     
                		         c.shift_name=p_shift_text and to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr and to_number(to_char(a.dt,'mi'))  between var_shift_start_time_min
       and var_shift_end_time_min and to_number(to_char(a.dt,'ss'))  between var_shift_start_time_sec
       and var_shift_end_time_sec   ;   
	                        END IF;
			END IF;
	if p_index=5 and  p_shift_specific=0  then -----------on user
		open p_test_cursor for
			select  a.m_code,a.m_name,
				a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
			        a.service_charge,
			        b.total_amt,
				b.disc,
				b.net_paid
			from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b
			where a.dt between p_dt1 and p_dt2 and a.reg_no=b.reg_no
			and a.u_id=p_text and a.reg_no=b.reg_no ;
		end if;
  if p_index=5 and p_shift_specific=1  then -------- DATE AND shift spcefic
 select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24')),
                to_number(to_char(shift_start_time,'mi')),to_number(to_char(shift_end_time,'mi')),
                to_number(to_char(shift_start_time,'ss')),to_number(to_char(shift_end_time,'ss'))
		 into 
                var_shift_start_time_hr,
		var_shift_end_time_hr ,
                var_shift_start_time_min,
		var_shift_end_time_min,  
                var_shift_start_time_sec,
		var_shift_end_time_sec     
                from shift_setup
				where shift_name=p_shift_text ;
		if var_shift_start_time_hr>var_shift_end_time_hr then       
                     		open p_test_cursor for
				select  a.m_code,a.m_name,
				a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
			        a.service_charge,
			        b.total_amt,
				b.disc,
				b.net_paid
				from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b, SHIFT_SETUP C
				where a.dt between p_dt1 and p_dt2 and a.reg_no=b.reg_no
				and a.u_id=p_text and a.reg_no=b.reg_no AND 
                              to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
	and 23 or  to_number(to_char(a.dt,'HH24')) between 0 and var_shift_end_time_hr;                ELSE
                       open p_test_cursor for
				select  a.m_code,a.m_name,
				a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
			        a.service_charge,
			        b.total_amt,
				b.disc,
				b.net_paid
				from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b, SHIFT_SETUP C
				where a.dt between p_dt1 and p_dt2 and a.reg_no=b.reg_no
				and a.u_id=p_text and a.reg_no=b.reg_no AND 
                                to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr;
                     END IF;
     end if;
  else
	if p_index=1 and p_shift_specific=0  then --------all
	open p_test_cursor for
	select  a.m_code,a.m_name,
	a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
        a.service_charge,
        b.total_amt,
	b.disc,
	b.net_paid
        from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b
      where to_char(a.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and a.reg_no=b.reg_no;
      end if;
if p_index=1 and p_shift_specific=1  then -------- DATE AND shift spcefic all
  select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24')),
                to_number(to_char(shift_start_time,'mi')),to_number(to_char(shift_end_time,'mi')),
                to_number(to_char(shift_start_time,'ss')),to_number(to_char(shift_end_time,'ss'))
		 into 
                var_shift_start_time_hr,
		var_shift_end_time_hr ,
                var_shift_start_time_min,
		var_shift_end_time_min,  
                var_shift_start_time_sec,
		var_shift_end_time_sec     
                from shift_setup
				where shift_name=p_shift_text ;
		if var_shift_start_time_hr>var_shift_end_time_hr then       
			 open p_test_cursor for
				 select  a.m_code,a.m_name,
				 a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
			        a.service_charge,  
			        b.total_amt,
				b.disc,
				b.net_paid
			from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b,shift_setup c
			where to_char(a.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and a.reg_no=b.reg_no AND 
                         to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
	and 23 or  to_number(to_char(a.dt,'HH24')) between 0 and var_shift_end_time_hr;
  ELSE
                      open p_test_cursor for
		     select  a.m_code,a.m_name,
		     a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
			        a.service_charge,  
			        b.total_amt,
				b.disc,
				b.net_paid
			from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b,shift_setup c
			where to_char(a.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and a.reg_no=b.reg_no AND
                          to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr;   
                   END IF;
	end if;
if p_index=2   then --------shift
 select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24')),
                to_number(to_char(shift_start_time,'mi')),to_number(to_char(shift_end_time,'mi')),
                to_number(to_char(shift_start_time,'ss')),to_number(to_char(shift_end_time,'ss'))
		 into 
                var_shift_start_time_hr,
		var_shift_end_time_hr ,
                var_shift_start_time_min,
		var_shift_end_time_min,  
                var_shift_start_time_sec,
		var_shift_end_time_sec     
                from shift_setup
				where shift_name=p_shift_text ;
if var_shift_start_time_hr>var_shift_end_time_hr then
open p_test_cursor for
select  a.m_code,a.m_name,
a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept, 
        a.service_charge,  
        b.total_amt,
	b.disc,
	b.net_paid
from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b
,shift_setup c
where  to_char(a.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and a.reg_no=b.reg_no
 and to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
	and 23 or  to_number(to_char(a.dt,'HH24')) between 0 and var_shift_end_time_hr;
else
open p_test_cursor for
select  a.m_code,a.m_name,
a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
        a.service_charge,
        b.total_amt,
	b.disc,
	b.net_paid
from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b
,shift_setup c
where  to_char(a.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and a.reg_no=b.reg_no
and c.shift_name=p_shift_text and to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr;
end if;
end if;
	if p_index=3 and p_shift_specific=0   then -----------on test_head
		open p_test_cursor for
			select  a.m_code,a.m_name,
			a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
		        a.service_charge, 
		        b.total_amt,
			b.disc,
			b.net_paid
			from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b
			where  to_char(a.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') 
			and a.m_name=p_text and a.reg_no=b.reg_no;
		end if;
if p_index=3 and p_shift_specific=1  then -------- DATE AND shift spcefic on test head
  select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24')),
                to_number(to_char(shift_start_time,'mi')),to_number(to_char(shift_end_time,'mi')),
                to_number(to_char(shift_start_time,'ss')),to_number(to_char(shift_end_time,'ss'))
		 into 
                var_shift_start_time_hr,
		var_shift_end_time_hr ,
                var_shift_start_time_min,
		var_shift_end_time_min,  
                var_shift_start_time_sec,
		var_shift_end_time_sec     
                from shift_setup
		where shift_name=p_shift_text ;
		if var_shift_start_time_hr>var_shift_end_time_hr then  
                       open p_test_cursor for
				select  a.m_code,a.m_name,
				a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
				        a.service_charge,
				        b.total_amt,
					b.disc,
					b.net_paid
					from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b,SHIFT_SETUP C
					where to_char(a.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') 
					and a.m_name=p_text and a.reg_no=b.reg_no
		                                        AND
                		         to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
	and 23 or  to_number(to_char(a.dt+1,'HH24')) between 0 and var_shift_end_time_hr;
                       ELSE
                            open p_test_cursor for
				select  a.m_code,a.m_name,
				a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
				        a.service_charge,
				        b.total_amt,
					b.disc,
					b.net_paid
					from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b,SHIFT_SETUP C
					where to_char(a.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and a.reg_no=b.reg_no
					and a.m_name=p_text and a.reg_no=b.reg_no
		                                        AND
                		        c.shift_name=p_shift_text and to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr ;   
                          END IF;                       
     end if;
	if p_index=4 and p_shift_specific=0 then -----------on doc_department
			open p_test_cursor for
				select  a.m_code,a.m_name,
					a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
				        a.service_charge,
			        b.total_amt,
					b.disc,
				b.net_paid
			from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b
				where  to_char(a.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and a.reg_no=b.reg_no
				and a.doc_dept=p_text and a.reg_no=b.reg_no;
				end if;
	if p_index=4 and p_shift_specific=1  then -------- DATE AND shift spcefic ON DOCTOR DEPARTMENT
			  select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24')),
                to_number(to_char(shift_start_time,'mi')),to_number(to_char(shift_end_time,'mi')),
                to_number(to_char(shift_start_time,'ss')),to_number(to_char(shift_end_time,'ss'))
		 into 
                var_shift_start_time_hr,
		var_shift_end_time_hr ,
                var_shift_start_time_min,
		var_shift_end_time_min,  
                var_shift_start_time_sec,
		var_shift_end_time_sec     
                from shift_setup
				where shift_name=p_shift_text ;
			if var_shift_start_time_hr>var_shift_end_time_hr then  
                          open p_test_cursor for
	                     select  a.m_code,a.m_name,
				a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
			        a.service_charge,
			        b.total_amt,
				b.disc,
				b.net_paid
				from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b ,SHIFT_SETUP C
			where to_char(a.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and a.reg_no=b.reg_no
			and a.doc_dept=p_text and a.reg_no=b.reg_no  AND		                                     
                		          c.shift_name=p_shift_text and to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
	and 23 or  to_number(to_char(a.dt,'HH24')) between 0 and var_shift_end_time_hr and
         to_number(to_char(a.dt,'mi')) between  var_shift_start_time_min and var_shift_end_time_min
         and to_number(to_char(a.dt,'ss')) between var_shift_start_time_sec and var_shift_end_time_sec; 
	ELSE
                        open p_test_cursor for
                        select  a.m_code,a.m_name,
			a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
		        a.service_charge,
		        b.total_amt,
			b.disc,
			b.net_paid
			from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b ,SHIFT_SETUP C
			where to_char(a.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and a.reg_no=b.reg_no
			and a.doc_dept=p_text and a.reg_no=b.reg_no  AND		                                     
                		        c.shift_name=p_shift_text and to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr and to_number(to_char(a.dt,'mi'))  between var_shift_start_time_min
       and var_shift_end_time_min and to_number(to_char(a.dt,'ss'))  between var_shift_start_time_sec
       and var_shift_end_time_sec   ;   
                        END IF;
END IF;
if p_index=5 and  p_shift_specific=0  then -----------on user
		open p_test_cursor for
	select  a.m_code,a.m_name,	
	a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
        a.service_charge,
        b.total_amt,
	b.disc,
	b.net_paid
	from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b
	where to_char(a.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and a.reg_no=b.reg_no
	and a.u_id=p_text ;
  END IF;
     if p_index=5 and p_shift_specific=1  then -------- DATE AND shift spcefic
 		 select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24')),
                to_number(to_char(shift_start_time,'mi')),to_number(to_char(shift_end_time,'mi')),
                to_number(to_char(shift_start_time,'ss')),to_number(to_char(shift_end_time,'ss'))
		 into 
                var_shift_start_time_hr,
		var_shift_end_time_hr ,
                var_shift_start_time_min,
		var_shift_end_time_min,  
                var_shift_start_time_sec,
		var_shift_end_time_sec     
                from shift_setup
				where shift_name=p_shift_text ;
		if var_shift_start_time_hr>var_shift_end_time_hr then       
                     open p_test_cursor for
				select  a.m_code,a.m_name,
				a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
			        a.service_charge,
			        b.total_amt,
				b.disc,
				b.net_paid
				from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b, SHIFT_SETUP C
				where to_char(a.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and a.reg_no=b.reg_no
				and a.u_id=p_text  AND 
                               to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
	and 23 or  to_number(to_char(a.dt+1,'HH24')) between 0 and var_shift_end_time_hr;
                   ELSE
                       open p_test_cursor for
				select  a.m_code,a.m_name,
				a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
			        a.service_charge,
			        b.total_amt,
				b.disc,
				b.net_paid
				from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b, SHIFT_SETUP C
				where to_char(a.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') 
				and a.u_id=p_text and a.reg_no=b.reg_no AND 
                                to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr;                   
                     END IF;
end if;
end if;
end Rptout_door_info;



















-------------------------------------------

create or replace procedure Rptout_door_info_summary
(p_test_cursor in out test_package.test_type,
	p_index in  integer,
	p_text in  varchar2,
	p_dt1 in  date,p_dt2 in  date,
	p_flag integer,
	p_date_spec date,
	p_shift_specific integer,
	p_shift_text varchar2)
    as
                var_shift_start_time_hr   number(10);
		var_shift_end_time_hr      number(10);
                var_shift_start_time_min  number(10);
		var_shift_end_time_min    number(10);  
                var_shift_start_time_sec   number(10);
		var_shift_end_time_sec   number(10);   
		var_shift_start_time varchar2(30);
		var_shift_end_time varchar2(30);
begin
delete from in_out_summary;
commit;
if p_flag=0 then  ---means not enabled AND NOT DATE SPECIFIC
     	if p_index=1 and p_shift_specific=0  then --------all   
             insert into in_out_summary(
			select   
		        sum(total_amt),
			Sum(disc),
			sum(net_paid)
			from pat_info_sub3_out_door 
			where dt between p_dt1 and p_dt2 and in_reg_no=0);
             insert into in_out_summary(
			select   
		        sum(total_amt),
			Sum(disc),
			sum(net_paid)
			from pat_info_sub3_out_door 
			where dt between p_dt1 and p_dt2 and in_reg_no!=0);
              open p_test_cursor for 
                     select * from    in_out_summary; 
	  END IF;

  if p_index=1 and p_shift_specific=1  then -------- DATE AND shift spcefic all
                select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24')),
                to_number(to_char(shift_start_time,'mi')),to_number(to_char(shift_end_time,'mi')),
                to_number(to_char(shift_start_time,'ss')),to_number(to_char(shift_end_time,'ss'))
		 into 
                var_shift_start_time_hr,
		var_shift_end_time_hr ,
                var_shift_start_time_min,
		var_shift_end_time_min,  
                var_shift_start_time_sec,
		var_shift_end_time_sec     
                from shift_setup
				where shift_name=p_shift_text ;
		if var_shift_start_time_hr>var_shift_end_time_hr then       
			 insert into in_out_summary(
				 select  
			        sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
			from pat_info_sub3_out_door b,shift_setup c
			where b.dt between p_dt1 and p_dt2  AND b.in_reg_no=0 and 
                         to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
         		and 23 or  to_number(to_char(b.dt,'HH24')) between 0 and var_shift_end_time_hr); 
                        insert into in_out_summary(
				 select  
			        sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
			from pat_info_sub3_out_door b,shift_setup c
			where b.dt between p_dt1 and p_dt2  AND b.in_reg_no!=0 and 
                         c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
         		and 23 or  to_number(to_char(b.dt,'HH24')) between 0 and var_shift_end_time_hr);
                         open p_test_cursor for select * from in_out_summary;
                 ELSE
                     insert into in_out_summary( 
		     select       
			       sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
			from pat_info_sub3_out_door b,shift_setup c
			where dt between p_dt1 and p_dt2 and b.in_reg_no=0 and 
     c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr );   
       insert into in_out_summary( 
		     select       
			       sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
			from pat_info_sub3_out_door b,shift_setup c
			where dt between p_dt1 and p_dt2 and b.in_reg_no!=0 and 
      to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr);
        open p_test_cursor for select * from in_out_summary;
                   END IF;
	end if;

if p_index=2 then --------shift
   select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24')),
                to_number(to_char(shift_start_time,'mi')),to_number(to_char(shift_end_time,'mi')),
                to_number(to_char(shift_start_time,'ss')),to_number(to_char(shift_end_time,'ss'))
		 into 
                var_shift_start_time_hr,
		var_shift_end_time_hr ,
                var_shift_start_time_min,
		var_shift_end_time_min,  
                var_shift_start_time_sec,
		var_shift_end_time_sec     
                from shift_setup
				where shift_name=p_shift_text ;
if var_shift_start_time_hr>var_shift_end_time_hr then
		  insert into in_out_summary( 
				select  
			        sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
from pat_info_sub3_out_door b
,shift_setup c
where b.dt between p_dt1 and p_dt2 and b.in_reg_no=0 and   c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
         		and 23 or  to_number(to_char(b.dt,'HH24')) between 0 and var_shift_end_time_hr); 
insert into in_out_summary( 
				select  
			        sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
from pat_info_sub3_out_door b
,shift_setup c
where b.dt between p_dt1 and p_dt2 and b.in_reg_no!=0 and  to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
         		and 23 or  to_number(to_char(b.dt,'HH24')) between 0 and var_shift_end_time_hr);
open p_test_cursor for select * from in_out_summary;
else
insert into in_out_summary( 
				select  
                                sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
from pat_info_sub3_out_door b
,shift_setup c
where b.dt between p_dt1 and p_dt2 and b.in_reg_no=0 and 
 c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr );  
insert into in_out_summary( 
				select  
                                sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
from pat_info_sub3_out_door b
,shift_setup c
where b.dt between p_dt1 and p_dt2 and b.in_reg_no!=0 and 
 c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr);
     open p_test_cursor for select * from in_out_summary;
end if;
end if;
	if p_index=5 and  p_shift_specific=0  then -----------on user
		insert into in_out_summary(
			select  
			        sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
			from pat_info_sub3_out_door b
			where b.dt between p_dt1 and p_dt2 and b.in_reg_no=0 and 
			 b.u_id=p_text ) ;
			insert into in_out_summary(
			select  
			        sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
			from pat_info_sub3_out_door b
			where b.dt between p_dt1 and p_dt2 and b.in_reg_no!=0 and 
			 b.u_id=p_text );
		open p_test_cursor for select * from in_out_summary;
		end if;
  if p_index=5 and p_shift_specific=1  then -------- DATE AND shift spcefic
 select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24')),
                to_number(to_char(shift_start_time,'mi')),to_number(to_char(shift_end_time,'mi')),
                to_number(to_char(shift_start_time,'ss')),to_number(to_char(shift_end_time,'ss'))
		 into 
                var_shift_start_time_hr,
		var_shift_end_time_hr ,
                var_shift_start_time_min,
		var_shift_end_time_min,  
                var_shift_start_time_sec,
		var_shift_end_time_sec     
                from shift_setup
				where shift_name=p_shift_text ;
		if var_shift_start_time_hr>var_shift_end_time_hr then       
                     		insert into in_out_summary(
				select 
			        sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
				from pat_info_sub3_out_door b, SHIFT_SETUP C
				where b.dt between p_dt1 and p_dt2 and b.in_reg_no=0 and
				b.u_id=p_text and 
                               to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
	and 23 or  to_number(to_char(b.dt,'HH24')) between 0 and var_shift_end_time_hr );
insert into in_out_summary(
				select 
			        sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
				from pat_info_sub3_out_door b, SHIFT_SETUP C
				where b.dt between p_dt1 and p_dt2 and b.in_reg_no!=0 and
				 b.u_id=p_text and 
                              c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
	and 23 or  to_number(to_char(b.dt,'HH24')) between 0 and var_shift_end_time_hr); 
             open p_test_cursor for select * from in_out_summary;
                   ELSE
                      insert into in_out_summary(
				select  
			       sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
				from pat_info_sub3_out_door b, SHIFT_SETUP C
				where b.dt between p_dt1 and p_dt2 and b.in_reg_no=0 and	 b.u_id=p_text and 
                                c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr);  
 insert into in_out_summary(
				select  
			       sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
				from pat_info_sub3_out_door b, SHIFT_SETUP C
				where b.dt between p_dt1 and p_dt2 and b.in_reg_no!=0 and b.u_id=p_text and 
                                 to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr );   
                   open p_test_cursor for select * from in_out_summary;
                     END IF;
     end if;
  else
	if p_index=1 and p_shift_specific=0  then --------all
	insert into in_out_summary(
	select  
         sum(b.total_amt),
	sum(b.disc),
	sum(b.net_paid)
        from pat_info_sub3_out_door b
      where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy')and b.in_reg_no=0);
	insert into in_out_summary(      
	select  
        	 sum(b.total_amt),
		sum(b.disc),
		sum(b.net_paid)
        from pat_info_sub3_out_door b
      where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy')and b.in_reg_no!=0);
	 open p_test_cursor for select * from in_out_summary;
     end if;
	if p_index=1 and p_shift_specific=1  then -------- DATE AND shift spcefic all
			  select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24')),
		                to_number(to_char(shift_start_time,'mi')),to_number(to_char(shift_end_time,'mi')),
	                to_number(to_char(shift_start_time,'ss')),to_number(to_char(shift_end_time,'ss'))
		 into 
                var_shift_start_time_hr,
		var_shift_end_time_hr ,
                var_shift_start_time_min,
		var_shift_end_time_min,  
                var_shift_start_time_sec,
		var_shift_end_time_sec     
                from shift_setup
				where shift_name=p_shift_text ;
		if var_shift_start_time_hr>var_shift_end_time_hr then       
			insert into in_out_summary(
				 select    
			        sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
			from pat_info_sub3_out_door b,shift_setup c
			where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and b.in_reg_no=0 
                     and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
	and 23 or  to_number(to_char(b.dt,'HH24')) between 0 and var_shift_end_time_hr);
	insert into in_out_summary(
				 select    
			        sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
			from pat_info_sub3_out_door b,shift_setup c
			where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and b.in_reg_no!=0 AND
                         c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
	and 23 or  to_number(to_char(b.dt,'HH24')) between 0 and var_shift_end_time_hr); 
			 open p_test_cursor for select * from in_out_summary;
  ELSE
                     insert into in_out_summary(
		     select  
			        sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
			from pat_info_sub3_out_door b,shift_setup c
			where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and b.in_reg_no=0 AND
                          to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr);  
insert into in_out_summary(
		     select  
			        sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
			from pat_info_sub3_out_door b,shift_setup c
			where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and b.in_reg_no!=0 AND
                         c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr);   
                open p_test_cursor for select * from in_out_summary;
                   END IF;
	end if;

if p_index=2   then --------shift
 select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24')),
                to_number(to_char(shift_start_time,'mi')),to_number(to_char(shift_end_time,'mi')),
                to_number(to_char(shift_start_time,'ss')),to_number(to_char(shift_end_time,'ss'))
		 into 
                var_shift_start_time_hr,
		var_shift_end_time_hr ,
                var_shift_start_time_min,
		var_shift_end_time_min,  
                var_shift_start_time_sec,
		var_shift_end_time_sec     
                from shift_setup
				where shift_name=p_shift_text ;
if var_shift_start_time_hr>var_shift_end_time_hr then
open p_test_cursor for
select  a.m_code,a.m_name,
a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept, 
        a.service_charge,  
        b.total_amt,
	b.disc,
	b.net_paid
from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b
,shift_setup c
where  to_char(a.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and a.reg_no=b.reg_no
and c.shift_name=p_shift_text and to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
	and 23 or  to_number(to_char(a.dt,'HH24')) between 0 and var_shift_end_time_hr );
else
open p_test_cursor for
select  a.m_code,a.m_name,
a.s_code,a.s_name,a.test_type,a.test_charge,a.doc_dept,
        a.service_charge,
        b.total_amt,
	b.disc,
	b.net_paid
from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b
,shift_setup c
where  to_char(a.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and a.reg_no=b.reg_no
and c.shift_name=p_shift_text and to_number(to_char(a.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr);
end if;
end if;  
if p_index=5 and  p_shift_specific=0  then -----------on user
		insert into in_out_summary(
	select  
        sum(b.total_amt),
	sum(b.disc),
	sum(b.net_paid)
	from pat_info_sub3_out_door b
	where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and b.in_reg_no=0 and
	b.u_id=p_text ) ;
insert into in_out_summary(
	select  
        sum(b.total_amt),
	sum(b.disc),
	sum(b.net_paid)
	from pat_info_sub3_out_door b
	where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and b.in_reg_no!=0 and
	 b.u_id=p_text ) ;
open p_test_cursor for select * from in_out_summary;
  END IF;
     if p_index=5 and p_shift_specific=1  then -------- DATE AND shift spcefic
 		 select to_number(to_char(shift_start_time,'HH24')),to_number(to_char(shift_end_time,'HH24')),
                to_number(to_char(shift_start_time,'mi')),to_number(to_char(shift_end_time,'mi')),
                to_number(to_char(shift_start_time,'ss')),to_number(to_char(shift_end_time,'ss'))
		 into 
                var_shift_start_time_hr,
		var_shift_end_time_hr ,
                var_shift_start_time_min,
		var_shift_end_time_min,  
                var_shift_start_time_sec,
		var_shift_end_time_sec     
                from shift_setup
				where shift_name=p_shift_text ;
		if var_shift_start_time_hr>var_shift_end_time_hr then       
                     insert into in_out_summary(
				select  
			        sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
				from pat_info_sub3_out_door b, SHIFT_SETUP C
				where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and 
			b.u_id=p_text and b.in_reg_no=0 AND 
                              c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
	and 23 or  to_number(to_char(b.dt,'HH24')) between 0 and var_shift_end_time_hr);
insert into in_out_summary(
				select  
			        sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
				from pat_info_sub3_out_door b, SHIFT_SETUP C
				where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy')
				and b.u_id=p_text and b.in_reg_no!=0 AND 
                              c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
	and 23 or  to_number(to_char(b.dt,'HH24')) between 0 and var_shift_end_time_hr); 
		open p_test_cursor for select * from in_out_summary;
                   ELSE
                       insert into in_out_summary(
				select  
			        sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
				from pat_info_sub3_out_door b, SHIFT_SETUP C
				where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and b.in_reg_no=0 and
				 b.u_id=p_text  AND 
                                c.shift_name=p_shift_text and to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr);  
 insert into in_out_summary(
				select  
			        sum(b.total_amt),
				sum(b.disc),
				sum(b.net_paid)
				from pat_info_sub3_out_door b, SHIFT_SETUP C
				where to_char(b.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and b.in_reg_no!=0 and
				b.u_id=p_text  AND 
                                 to_number(to_char(b.dt,'HH24')) between var_shift_start_time_hr
       and var_shift_end_time_hr);
open p_test_cursor for select * from in_out_summary;                    
                     END IF;
end if;
end if;
end Rptout_door_info_summary;













-------------------procedure RptPatientRelease

create or replace procedure RptPatientRelease
(p_test_cursor in out test_package.test_type,
p_in_reg_no in number,P_YRCODE VARCHAR2)
as
begin
open p_test_cursor for
select a.in_reg_no ,a.pat_name,
a. BED_EXTRA_FLAG_PRINT,
B.doc_dept,
a.admission_date,
b.bed_no,
b.bed_type,
b.bed_type_no,
b.bed_charge,
c.admission_charge,
c.advance ,
c.test_sum ,-----------pathology
c.total_operation_sum ,
c.bed_sum,
c.discount,
c.total,
c.miscelleneous_charge,
c.total_with_misce,
c.extra_bed_charge,
c.anesthesia_charge ,
c.delivery_charge ,
c.baby_charge ,
c.pathology_charge,
c.service_charge ,
c.baby_care_charge ,
c.neunetal_bed_charge, 
c.Exchange_transfusion_charge,
c.photo_therapy_charge,
c.blood_sugar_charge ,
c.medicine_charge ,
c.cardiology_charge ,
c.net_total_charge,
c.nebuliser_charge,
c.service_charge,
 (select user_name from security where user_id=c.u_id) as "User Name",
c.pat_id,
c.dt,
a.release_flag,
c.staff_poor_patient_flag,
c.INCUBATOR_CHARGE,
C.STAFF_ID AS STAFF_ID
from 
in_door_pat_info_main a, 
indoor_pat_bed_info b,
indoor_pat_money c
where (a.in_reg_no=p_in_reg_no AND A.YRCODE=P_YRCODE)
and (a.in_reg_no=b.in_reg_no AND B.YRCODE=P_YRCODE)
and (a.in_reg_no=c.in_reg_no AND C.YRCODE=P_YRCODE)
and b.SERIAL_NO=(select max(SERIAL_NO) from indoor_pat_bed_info where in_reg_no=b.in_reg_no AND YRCODE=P_YRCODE);
end RptPatientRelease;






-------------------procedure RptPatientRelease_not_child

create or replace procedure RptPatientRelease_not_child
(p_test_cursor in out test_package.test_type,
p_in_reg_no in number)
as
begin
open p_test_cursor for
select b.in_reg_no ,a.pat_name,
a.doc_dept,
a.admission_date,
b.bed_no,
b.bed_type,
b.bed_type_no,
b.bed_charge,
c.admission_charge,
c.advance ,
c.test_sum ,-----------pathology
c.total_operation_sum ,
c.bed_sum,
c.discount,
c.total,
c.miscelleneous_charge,
c.total_with_misce,
c.extra_bed_charge,
c.anesthesia_charge ,
c.delivery_charge ,
c.service_charge ,
c.cardiology_charge ,
c.net_total_charge,
 (select user_name from security where user_id=c.u_id) as "User Name",
c.pat_id,
c.dt
from 
in_door_pat_info_main a,
indoor_pat_bed_info b,
indoor_pat_money c
where a.in_reg_no=p_in_reg_no
and a.in_reg_no=b.in_reg_no
and a.in_reg_no=c.in_reg_no;
end RptPatientRelease_not_child;


-----------------procedure Rpt_doc

create or replace procedure Rpt_doc(p_test_cursor in out test_package.test_type
)
as
begin
--if p_index=1 then 
open p_test_cursor for

---if p_index=1 then           -----show all
select * FROM DOCTOR_INFO;
/* refer_code  "Refer Code" ,
--f_name+' '+m_name+' '+l_name as
--"Doctor Name",
degree
as Degree ,
Doc_dept as Department,
addr as Address,
phone as Phone ,
fax as Fax,
email as "E-mail",
birth_date as "Birth Date",
marriage_status as "Martial Status"
from doctor_info;
end if;
if p_index=2 then
open p_test_cursor for
select refer_code  "Refer Code" ,
--f_name+' '+m_name+' '+l_name as	
--"Doctor Name",
degree
as Degree ,
Doc_dept as Department,
addr as Address,
phone as Phone ,
fax as Fax,
email as "E-mail",
birth_date as "Birth Date",
marriage_status as "Martial Status"
from doctor_info
where doc_dept=p_doc_dept;
end if;*/
--end p_test_cursor;
end Rpt_doc;





-------------------------------rpt indoor_info---------------------------
---------------------Rptindoor_door_info---------------------

create or replace procedure RptIn_door_info(p_test_cursor in out test_package.test_type,
p_index in  integer,
p_text in  varchar2,
p_dt1 in  date,
p_dt2 in  date,
p_flag integer,
p_date_spec date)
as
var_shift_start_time varchar2(30);
var_shift_end_time varchar2(30);
begin
if p_flag=0 then  ---means not enabled
  if p_index=1 then --------all
open p_test_cursor for
select  a.advance ,
 a.test_sum ,-----------pathology
 a.total_operation_sum ,
 a.admission_charge ,
 a.bed_sum,
 a.discount,
 a.total,
 a.miscelleneous_charge ,
 a.total_with_misce ,
 a.extra_bed_charge ,
 a.anesthesia_charge ,
 a.delivery_charge ,
 a.baby_charge     ,
 a.pathology_charge ,
 a.service_charge  ,
 a.baby_care_charge ,
 a.neunetal_bed_charge , 
 a.Exchange_transfusion_charge ,
 a.photo_therapy_charge ,
 a.blood_sugar_charge ,
 a.medicine_charge,
 a.cardiology_charge ,
 a.net_total_charge ,
 a.u_id ,
 a.booth_no ,
 b.doc_dept 
from indoor_pat_money a,in_door_Pat_Info_Main b
where a.dt between p_dt1 and p_dt2 and a.in_reg_no=b.in_reg_no ;
end if;
if p_index=2 then --------shift
open p_test_cursor for
select  a.advance ,
 a.test_sum ,-----------pathology
 a.total_operation_sum ,
 a.admission_charge ,
 a.bed_sum,
 a.discount,
 a.total,
 a.miscelleneous_charge ,
 a.total_with_misce ,
 a.extra_bed_charge ,
 a.anesthesia_charge ,
 a.delivery_charge ,
 a.baby_charge     ,
 a.pathology_charge ,
 a.service_charge  ,
 a.baby_care_charge ,
 a.neunetal_bed_charge , 
 a.Exchange_transfusion_charge ,
 a.photo_therapy_charge ,
 a.blood_sugar_charge ,
 a.medicine_charge,
 a.cardiology_charge ,
 a.net_total_charge ,
 a.u_id ,
 a.booth_no ,
 b.doc_dept
from indoor_pat_money a,in_door_Pat_Info_Main b,shift_setup c
where a.dt between p_dt1 and p_dt2 and a.in_reg_no=b.in_reg_no
 and to_char(a.dt,'HH24') between var_shift_start_time
and var_shift_end_time  and a.in_reg_no=b.in_reg_no;
end if;
if p_index=3  then -----------on test_head
open p_test_cursor for
select  a.m_code,a.m_name,
a.s_code,a.s_name,a.test_type,
a.test_charge,a.doc_dept,
        b.total_amt,
	b.disc,
	b.net_paid
from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b
where a.dt between p_dt1 and p_dt2 and a.in_reg_no!=0
and a.m_name=p_text and a.reg_no=b.reg_no ;
end if;
if p_index=4 then -----------on doc_department
open p_test_cursor for
select  a.advance ,
 a.test_sum ,-----------pathology
 a.total_operation_sum ,
 a.admission_charge ,
 a.bed_sum ,
 a.discount,
 a.total,
 a.miscelleneous_charge ,
 a.total_with_misce ,
 a.extra_bed_charge ,
 a.anesthesia_charge ,
 a.delivery_charge ,
 a.baby_charge     ,
 a.pathology_charge ,
 a.service_charge  ,
 a.baby_care_charge ,
 a.neunetal_bed_charge , 
 a.Exchange_transfusion_charge ,
 a.photo_therapy_charge ,
 a.blood_sugar_charge ,
 a.medicine_charge,
 a.cardiology_charge ,
 a.net_total_charge ,
 a.u_id ,
 a.booth_no
from indoor_pat_money a,in_door_Pat_Info_Main b
where a.dt between p_dt1 and p_dt2 and a.in_reg_no=b.in_reg_no 
and b.doc_dept=p_text ;
end if;
  else
	if p_index=1 then --------all
	open p_test_cursor for
select  a.advance ,
 a.test_sum ,-----------pathology
 a.total_operation_sum ,
 a.admission_charge ,
 a.bed_sum,
 a.discount,
 a.total,
 a.miscelleneous_charge ,
 a.total_with_misce ,
 a.extra_bed_charge ,
 a.anesthesia_charge ,
 a.delivery_charge ,
 a.baby_charge     ,
 a.pathology_charge ,
 a.service_charge  ,
 a.baby_care_charge ,
 a.neunetal_bed_charge , 
 a.Exchange_transfusion_charge ,
 a.photo_therapy_charge ,
 a.blood_sugar_charge ,
 a.medicine_charge,
 a.cardiology_charge ,
 a.net_total_charge ,
 a.u_id ,
 a.booth_no ,
 b.doc_dept  
from indoor_pat_money a,in_door_Pat_Info_Main b
where to_char(a.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and a.in_reg_no=b.in_reg_no;
end if;
if p_index=2 then --------shift
open p_test_cursor for
 select  a.advance ,
 a.test_sum ,-----------pathology
 a.total_operation_sum ,
 a.admission_charge ,
 a.bed_sum,
 a.discount,
 a.total,
 a.miscelleneous_charge ,
 a.total_with_misce ,
 a.extra_bed_charge ,
 a.anesthesia_charge ,
 a.delivery_charge ,
 a.baby_charge     ,
 a.pathology_charge ,
 a.service_charge  ,
 a.baby_care_charge ,
 a.neunetal_bed_charge , 
 a.Exchange_transfusion_charge ,
 a.photo_therapy_charge ,
 a.blood_sugar_charge ,
 a.medicine_charge,
 a.cardiology_charge ,
 a.net_total_charge ,
 a.u_id,
 a.booth_no ,
 b.doc_dept
from indoor_pat_money a,in_door_Pat_Info_Main b,shift_setup c
where  to_char(a.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') 
and c.shift_name=p_text and to_char(a.dt,'HH24') between var_shift_start_time
and var_shift_end_time and a.in_reg_no=b.in_reg_no ;
end if;
if p_index=3  then -----------on test_head
open p_test_cursor for
select  a.m_code,a.m_name,
a.s_code,a.s_name,a.test_type,
a.test_charge,a.doc_dept,
        b.total_amt,
	b.disc,
	b.net_paid
from Pat_Info_Sub1_out_door a ,pat_info_sub3_out_door b
where to_char(a.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy') and a.in_reg_no!=0
and a.m_name=p_text and a.reg_no=b.reg_no ;
end if;

if p_index=4  then -----------on doc_dept_head
open p_test_cursor for
select  a.advance ,
 a.test_sum ,-----------pathology
 a.total_operation_sum ,
 a.admission_charge ,
 a.bed_sum ,
 a.discount,
 a.total ,
 a.miscelleneous_charge ,
 a.total_with_misce ,
 a.extra_bed_charge ,
 a.anesthesia_charge ,
 a.delivery_charge ,
 a.baby_charge     ,
 a.pathology_charge ,
 a.service_charge  ,
 a.baby_care_charge ,
 a.neunetal_bed_charge , 
 a.Exchange_transfusion_charge ,
 a.photo_therapy_charge ,
 a.blood_sugar_charge ,
 a.medicine_charge ,
 a.cardiology_charge ,
 a.net_total_charge ,
 a.u_id ,
 a.booth_no
from indoor_pat_money a,in_door_Pat_Info_Main b
where  a.in_reg_no=b.in_reg_no 
and b.doc_dept=p_text and to_char(a.dt,'dd-mon-yyyy')=to_char(p_date_spec,'dd-mon-yyyy'); 
end if;
end if;
end RptIn_door_info;











create or replace procedure Rpt_indoor_coll_sum
(p_test_cursor in out test_package.test_type,
p_dt1 in  date,
p_dt2 in  date,
p_flag integer,
p_index integer,
p_text varchar2
)
as
DISCOUNT_INDOOR NUMBER;
DISCOUNT_OUTDOOR NUMBER;
DISCOUNT_TOTAL NUMBER;
begin
   if p_flag=0 then --- means not date specific
       if p_index=1  then
                 IF UPPER(P_TEXT)=UPPER('MEDICINE-1') OR UPPER(P_TEXT)=UPPER('MEDICINE-2')  OR UPPER(P_TEXT)=UPPER('MEDICINE-3')  THEN


                  select sum(a.DISCOUNT)  INTO DISCOUNT_INDOOR
                    from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)));


                    	select NVL(sum(DISC),0)/3 into DISCOUNT_OUTDOOR from pat_info_sub3_out_door
                                      where upper(doc_dept)=UPPER('MEDICINE')
                             and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)));

                    DISCOUNT_TOTAL:=DISCOUNT_INDOOR+DISCOUNT_OUTDOOR;


                     open p_test_cursor for
                       select 1 as grp_title , 1 as  serial ,'Admission Charge' as col_name,sum(a.ADMISSION_CHARGE) as col_value,0 AS DISCOUNT
                           from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
                   union
			select 1 as grp_title ,2 AS serial,'Bed Charge' as col_name,sum(a.Bed_sum) as col_value,0 AS DISCOUNT
                              from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
                 union
			select 1 as grp_title ,3 AS serial,'Extra Bed Charge' as col_name,sum(a.EXTRA_BED_CHARGE) as col_value,0 AS DISCOUNT
                           from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
                   union
			select 1 as grp_title ,4 AS serial,'Service Charge' as col_name,sum(a.SERVICE_CHARGE ) as col_value,0 AS DISCOUNT
                     from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
                    union
			select 1 as grp_title ,5 AS serial,'Blood Sugar Charge' as col_name,sum(a.BLOOD_SUGAR_CHARGE ) as col_value,0 AS DISCOUNT      from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
                        union
			select 1 as grp_title ,6 AS serial,'Medicine Charge' as col_name,sum(a.MEDICINE_CHARGE) as col_value,0 AS DISCOUNT
                       from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
             union
			select 1 as grp_title ,7 AS serial,' Miscelleneous Charge ' as col_name,sum(a.MISCELLENEOUS_CHARGE ) as col_value,0 AS DISCOUNT
                      from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))

               union
			select 1 as grp_title ,8 AS serial,'OUTDOOR Examination Charge' as col_name, NVL(sum(total_amt),0)/3 AS col_value ,0 AS DISCOUNT from pat_info_sub3_out_door
                                      where upper(doc_dept)=UPPER('MEDICINE') and in_reg_no=0
                             and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
	    union
			select 1 as grp_title ,9 AS serial,'INDOOR Examination Charge' as col_name, NVL(sum(total_amt),0) AS col_value ,0 AS DISCOUNT from pat_info_sub3_out_door
                                      where upper(doc_dept)=UPPER(p_text) and in_reg_no<>0
                             and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))




			 union
			select 1 as grp_title ,10 AS serial,'  ' as col_name,0 as col_value,DISCOUNT_TOTAL  AS DISCOUNT
                    from  DUAL;


           ELSIF UPPER(P_TEXT)=UPPER('SURGERY-1') OR UPPER(P_TEXT)=UPPER('SURGERY-2') OR UPPER(P_TEXT)=UPPER('SURGERY-3')   THEN

                   select sum(a.DISCOUNT)  INTO DISCOUNT_INDOOR
                    from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)));


                    	select NVL(sum(DISC),0)/3 into DISCOUNT_OUTDOOR from pat_info_sub3_out_door
                                      where upper(doc_dept)=UPPER('SURGERY')
                             and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)));

                    DISCOUNT_TOTAL:=DISCOUNT_INDOOR+DISCOUNT_OUTDOOR;

                     open p_test_cursor for
                       select 2 as grp_title , 1 as  serial ,'Admission Charge' as col_name,sum(a.ADMISSION_CHARGE) as col_value,0 AS DISCOUNT
                         from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
          union
			select 2 as grp_title ,2 AS serial,'Bed Charge' as col_name,sum(a.Bed_sum) as col_value,0 AS DISCOUNT
                              from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
                  union
			select 2 as grp_title ,3 AS serial,'Extra Bed Charge' as col_name,sum(a.EXTRA_BED_CHARGE) as col_value,0 AS DISCOUNT
                            from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
         union
			select 2 as grp_title ,4 AS serial,'Service Charge' as col_name,sum(a.SERVICE_CHARGE ) as col_value,0 AS DISCOUNT
                           from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
      union
			select 2 as grp_title ,5 AS serial,'Operation Charge' as col_name,sum(a.OPERATION_SUM ) as col_value,0 AS DISCOUNT
                      from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
        union
			select 2 as grp_title ,6 AS serial,'Medicine Charge' as col_name,sum(a.MEDICINE_CHARGE) as col_value,0 AS DISCOUNT
                           from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
    union
			select 2 as grp_title ,7 AS serial,' Miscelleneous Charge ' as col_name,sum(a.MISCELLENEOUS_CHARGE ) as col_value,0 AS DISCOUNT
                           from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
	    union
			select 2 as grp_title ,8 AS serial,'OUTDOOR Examination Charge' as col_name, NVL(sum(total_amt),0)/3 AS col_value ,0 AS DISCOUNT from pat_info_sub3_out_door
                                      where upper(doc_dept)=UPPER('SURGERY') and in_reg_no=0
                             and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
	    union
			select 2 as grp_title ,9 AS serial,'INDOOR Examination Charge' as col_name, NVL(sum(total_amt),0) AS col_value ,0 AS DISCOUNT from pat_info_sub3_out_door
                                      where upper(doc_dept)=UPPER(p_text) and in_reg_no<>0
                             and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))




			 union
			select 2 as grp_title ,10 AS serial,'  ' as col_name,0 as col_value,DISCOUNT_TOTAL  AS DISCOUNT
                    from  DUAL;



           ELSIF  UPPER(P_TEXT)=UPPER('ENT') OR UPPER(P_TEXT)=UPPER('Skin VD') OR UPPER(P_TEXT)=UPPER('Ortho.')  THEN

                   select sum(a.DISCOUNT)  INTO DISCOUNT_INDOOR
                    from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)));


                    	select NVL(sum(DISC),0) into DISCOUNT_OUTDOOR from pat_info_sub3_out_door
                                      where upper(doc_dept)=UPPER(p_text)
                             and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)));

                    DISCOUNT_TOTAL:=DISCOUNT_INDOOR+DISCOUNT_OUTDOOR;

                     open p_test_cursor for
                       select 2 as grp_title , 1 as  serial ,'Admission Charge' as col_name,sum(a.ADMISSION_CHARGE) as col_value,0 AS DISCOUNT
                         from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
          union
			select 2 as grp_title ,2 AS serial,'Bed Charge' as col_name,sum(a.Bed_sum) as col_value,0 AS DISCOUNT
                              from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
                  union
			select 2 as grp_title ,3 AS serial,'Extra Bed Charge' as col_name,sum(a.EXTRA_BED_CHARGE) as col_value,0 AS DISCOUNT
                            from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
         union
			select 2 as grp_title ,4 AS serial,'Service Charge' as col_name,sum(a.SERVICE_CHARGE ) as col_value,0 AS DISCOUNT
                           from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
      union
			select 2 as grp_title ,5 AS serial,'Operation Charge' as col_name,sum(a.OPERATION_SUM ) as col_value,0 AS DISCOUNT
                      from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
        union
			select 2 as grp_title ,6 AS serial,'Medicine Charge' as col_name,sum(a.MEDICINE_CHARGE) as col_value,0 AS DISCOUNT
                           from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
    union
			select 2 as grp_title ,7 AS serial,' Miscelleneous Charge ' as col_name,sum(a.MISCELLENEOUS_CHARGE ) as col_value,0 AS DISCOUNT
                           from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
	    union
			select 2 as grp_title ,8 AS serial,'OUTDOOR Investigation Charge(Including Reff.)' as col_name, NVL(sum(total_amt),0) AS col_value ,0 AS DISCOUNT from pat_info_sub3_out_door
                                      where upper(doc_dept)=UPPER(p_text) and in_reg_no=0
                             and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
	    union
			select 2 as grp_title ,9 AS serial,'INDOOR Investigation Charge(Including Reff.)' as col_name, NVL(sum(total_amt),0) AS col_value ,0 AS DISCOUNT from pat_info_sub3_out_door
                                      where upper(doc_dept)=UPPER(p_text) and in_reg_no<>0
                             and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))




			 union
			select 2 as grp_title ,10 AS serial,'  ' as col_name,0 as col_value,DISCOUNT_TOTAL  AS DISCOUNT
                    from  DUAL;

        ELSIF UPPER(P_TEXT)=UPPER('GYNAE-1') OR UPPER(P_TEXT)=UPPER('GYNAE-2') OR UPPER(P_TEXT)=UPPER('GYNAE-3')  THEN

              select sum(a.DISCOUNT)  INTO DISCOUNT_INDOOR
                    from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)));


                    	select NVL(sum(DISC),0)/3 into DISCOUNT_OUTDOOR from pat_info_sub3_out_door
                                      where upper(doc_dept)=UPPER('GYNAE')
                             and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)));

                    DISCOUNT_TOTAL:=DISCOUNT_INDOOR+DISCOUNT_OUTDOOR;


                     open p_test_cursor for
                       select 3 as grp_title , 1 as  serial ,'Admission Charge' as col_name,sum(a.ADMISSION_CHARGE) as col_value,0 AS DISCOUNT
				    from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
          union
			select 3 as grp_title ,2 AS serial,'Bed Charge' as col_name,sum(a.Bed_sum) as col_value,0 AS DISCOUNT
                            from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))

             union
			select 3 as grp_title ,3 AS serial,'Extra Bed Charge' as col_name,sum(a.EXTRA_BED_CHARGE) as col_value,0 AS DISCOUNT
                        from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
          union
			select 3 as grp_title ,4 AS serial,'Service Charge' as col_name,sum(a.SERVICE_CHARGE ) as col_value,0 AS DISCOUNT
                    from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
       union
			select 3 as grp_title ,5 AS serial,'Operation Charge' as col_name,sum(a.OPERATION_SUM ) as col_value,0 AS DISCOUNT
                        from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
          union
			select 3 as grp_title ,6 AS serial,'Delivery Charge' as col_name,sum(a.DELIVERY_CHARGE) as col_value,0 AS DISCOUNT
                     from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
      union
			select 3 as grp_title ,7 AS serial,'Medicine Charge' as col_name,sum(a.MEDICINE_CHARGE) as col_value,0 AS DISCOUNT
                     from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
         union
			select 3 as grp_title ,8 AS serial,' Miscelleneous Charge ' as col_name,sum(a.MISCELLENEOUS_CHARGE ) as col_value,0 AS DISCOUNT
                      from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))

        union
			select 3 as grp_title ,9 AS serial,'OUTDOOR Examination Charge' as col_name, NVL(sum(total_amt),0)/3 AS col_value ,0 AS DISCOUNT from pat_info_sub3_out_door
                                      where upper(doc_dept)=UPPER('GYNAE') and in_reg_no=0
                             and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))

    union
			select 3 as grp_title ,10 AS serial,'INDOOR Examination Charge' as col_name, NVL(sum(total_amt),0) AS col_value ,0 AS DISCOUNT from pat_info_sub3_out_door
                                      where upper(doc_dept)=UPPER(p_text) and in_reg_no<>0
                             and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))

			 union
			select 3 as grp_title ,11 AS serial,'  ' as col_name,0 as col_value,DISCOUNT_TOTAL  AS DISCOUNT
                    from  DUAL;



     ELSIF UPPER(P_TEXT)=UPPER('card.')   THEN

                   select sum(a.DISCOUNT)  INTO DISCOUNT_INDOOR
                    from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)));


                     select sum(disc) INTO DISCOUNT_OUTDOOR from pat_info_sub3_out_door
                       where reg_no in (select distinct(reg_no)
                                                from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code)  in (TO_NUMBER('07'))   and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))) ;

                    DISCOUNT_TOTAL:=DISCOUNT_INDOOR+DISCOUNT_OUTDOOR;

                     open p_test_cursor for
                       select 4 as grp_title , 1 as  serial ,'Admission Charge' as col_name,sum(a.ADMISSION_CHARGE) as col_value,0 AS DISCOUNT
                     from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
           union
			select 4 as grp_title ,2 AS serial,'Bed Charge' as col_name,sum(a.Bed_sum) as col_value,0 AS DISCOUNT
               from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
           union
			select 4 as grp_title ,3 AS serial,'Extra Bed Charge' as col_name,sum(a.EXTRA_BED_CHARGE) as col_value,0 AS DISCOUNT
                     from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
       union
			select 4 as grp_title ,4 AS serial,'Service Charge' as col_name,sum(a.SERVICE_CHARGE ) as col_value,0 AS DISCOUNT
                         from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
       union
			select 4 as grp_title ,5 AS serial,'C.C.U Charge' as col_name,sum(a.CARDIOLOGY_CHARGE ) as col_value,0 AS DISCOUNT
                      from  indoor_pat_DEPT_INFO a
                          where   A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))


                  union
			select 4 as grp_title ,6 AS serial,'Medicine Charge' as col_name,sum(a.MEDICINE_CHARGE) as col_value,0 AS DISCOUNT
                  from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
        union
			select 4 as grp_title ,7 AS serial,' Miscelleneous Charge ' as col_name,sum(a.MISCELLENEOUS_CHARGE ) as col_value,0 AS DISCOUNT
                   from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))

          
            union
			select 4 as grp_title ,8 AS serial,'E.T.T  Charge' as col_name, NVL(sum(test_charge),0) AS col_value ,0 AS DISCOUNT from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code)  in (TO_NUMBER('07')) and  TO_NUMBER(s_code) in(TO_NUMBER('03'))  and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
             union
			select 4 as grp_title ,9 AS serial,'E.C.G  Charge' as col_name, NVL(sum(test_charge),0) AS col_value ,0 AS DISCOUNT from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code)  in (TO_NUMBER('07')) and TO_NUMBER(s_code) in(TO_NUMBER('01'),TO_NUMBER('02'))  and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
              union
			select 4 as grp_title ,10 AS serial,'Echo Charge' as col_name, NVL(sum(test_charge),0) AS col_value ,0 AS DISCOUNT from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code)  in (TO_NUMBER('07')) and TO_NUMBER(s_code) in(TO_NUMBER('04'),TO_NUMBER('05'))  and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))


           union
			select 4 as grp_title ,11 AS serial,'Pericardinal Fluid Aspiration' as col_name, NVL(sum(test_charge),0) AS col_value ,0 AS DISCOUNT from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code)  in (TO_NUMBER('07')) and TO_NUMBER(s_code) in(TO_NUMBER('06')) and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))


               union
                    select 4 as grp_title ,12 AS serial,'Out-door Investigation Charge(Reff. from Card. to other dept.)' as col_name, NVL(sum(test_charge),0) AS col_value ,0 AS DISCOUNT from pat_info_sub1_out_door  where
					                 (TO_NUMBER(m_code) not in (TO_NUMBER('07')) and doc_dept='Card.') and  in_reg_no=0 and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
              union
                    select 4 as grp_title ,13 AS serial,'In-door Investigation Charge(Reff. from Card. to other dept.)' as col_name, NVL(sum(test_charge),0) AS col_value ,0 AS DISCOUNT from pat_info_sub1_out_door  where
					                 (TO_NUMBER(m_code) not in (TO_NUMBER('07')) and doc_dept='Card.' )and  in_reg_no<>0 and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))

        
 			 union
			select 4 as grp_title ,14 AS serial,'  ' as col_name,0 as col_value,DISCOUNT_TOTAL  AS DISCOUNT
                    from  DUAL;




            ELSIF UPPER(P_TEXT)=UPPER('ophth.')   THEN

                select sum(a.DISCOUNT)  INTO DISCOUNT_INDOOR
                    from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)));


                    	select NVL(sum(DISC),0) into DISCOUNT_OUTDOOR from pat_info_sub3_out_door
                                      where upper(doc_dept)=UPPER(P_TEXT)
                             and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)));

                    DISCOUNT_TOTAL:=DISCOUNT_INDOOR+DISCOUNT_OUTDOOR;

                     open p_test_cursor for
                       select 5 as grp_title , 1 as  serial ,'Admission Charge' as col_name,sum(a.ADMISSION_CHARGE) as col_value,0 AS DISCOUNT
                      from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
           union
			select 5 as grp_title ,2 AS serial,'Bed Charge' as col_name,sum(a.Bed_sum) as col_value,0 AS DISCOUNT
                   from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
             union
			select 5 as grp_title ,3 AS serial,'Extra Bed Charge' as col_name,sum(a.EXTRA_BED_CHARGE) as col_value,0 AS DISCOUNT
                     from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
          union
			select 5 as grp_title ,4 AS serial,'Service Charge' as col_name,sum(a.SERVICE_CHARGE ) as col_value,0 AS DISCOUNT
                from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
          union
			select 5 as grp_title ,5 AS serial,'Operation Charge' as col_name,sum(a.OPERATION_SUM ) as col_value,0 AS DISCOUNT
           from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))


/*
          union
             		select 5 as grp_title ,6 AS serial,'Eye Exam. Charge' as col_name, NVL(sum(test_charge),0) AS col_value ,0 AS DISCOUNT from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code)  in (TO_NUMBER('17'))   and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
*/


              union
			select 5 as grp_title ,6 AS serial,'Medicine Charge' as col_name,sum(a.MEDICINE_CHARGE) as col_value,0 AS DISCOUNT
                  from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
         union
			select 5 as grp_title ,7 AS serial,' Miscelleneous Charge ' as col_name,sum(a.MISCELLENEOUS_CHARGE ) as col_value ,0 AS DISCOUNT
                 from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
       	 union
			select 5 as grp_title ,8 AS serial,'OUTDOOR Examination Charge' as col_name, NVL(sum(total_amt),0) AS col_value ,0 AS DISCOUNT from pat_info_sub3_out_door
                                      where upper(doc_dept)=UPPER(p_text) and in_reg_no=0
                             and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))

    union
			select 5 as grp_title ,9 AS serial,'INDOOR Examination Charge' as col_name, NVL(sum(total_amt),0) AS col_value ,0 AS DISCOUNT from pat_info_sub3_out_door
                                      where upper(doc_dept)=UPPER(p_text) and in_reg_no<>0
                             and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))

			 union
			select 5 as grp_title ,10 AS serial,'  ' as col_name,0 as col_value,DISCOUNT_TOTAL  AS DISCOUNT
                    from  DUAL;

         ELSIF UPPER(P_TEXT)=UPPER('Paediatric')   THEN

                  select sum(a.DISCOUNT)  INTO DISCOUNT_INDOOR
                    from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)));


                    	select NVL(sum(DISC),0) into DISCOUNT_OUTDOOR from pat_info_sub3_out_door
                                      where upper(doc_dept)=UPPER(P_TEXT)
                             and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)));

                    DISCOUNT_TOTAL:=DISCOUNT_INDOOR+DISCOUNT_OUTDOOR;

                     open p_test_cursor for
                       select 6 as grp_title , 1 as  serial ,'Admission Charge' as col_name,sum(a.ADMISSION_CHARGE) as col_value,0 as discount
                        from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
          union
			select 6 as grp_title ,2 AS serial,'Bed Charge' as col_name,sum(a.Bed_sum) as col_value,0 as discount
                          from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
            union
			select 6 as grp_title ,3 AS serial,'Extra Bed Charge' as col_name,sum(a.EXTRA_BED_CHARGE) as col_value,0 as discount
                        from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
           union
			select 6 as grp_title ,4 AS serial,'Service Charge' as col_name,sum(a.SERVICE_CHARGE ) as col_value,0 as discount
                     from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
            union
			select 6 as grp_title ,5 AS serial,'Baby Care Charge' as col_name,sum(a.BABY_CARE_CHARGE) as col_value,0 as discount
                from  indoor_pat_DEPT_INFO a
                          where   A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
         union
			select 6 as grp_title ,6 AS serial,'Neunetal Bed Charge' as col_name,sum(a.NEUNETAL_BED_CHARGE) as col_value,0 as discount
                     from  indoor_pat_DEPT_INFO a
                          where   A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
         union
			select 6 as grp_title ,7 AS serial,'Exchance Transfusion Charge' as col_name,sum(a.EXCHANGE_TRANSFUSION_CHARGE) as col_value,0 as discount
                      from  indoor_pat_DEPT_INFO a
                          where   A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
       union
			select 6 as grp_title ,8 AS serial,'Photo Therapy Charge' as col_name,sum(a.PHOTO_THERAPY_CHARGE) as col_value,0 as discount
                          from  indoor_pat_DEPT_INFO a
                          where   A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
          union
			select 6 as grp_title ,9 AS serial,'Incubator Charge' as col_name,sum(a.INCUBATOR_CHARGE) as col_value,0 as discount
                    from  indoor_pat_DEPT_INFO a
                          where   A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
             union
			select 6 as grp_title ,10 AS serial,'Medicine Charge' as col_name,sum(a.MEDICINE_CHARGE) as col_value ,0 as discount
                   from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
           union
			select 6 as grp_title ,11 AS serial,' Blood Sugar Charge ' as col_name,sum(a.blood_sugar_charge ) as col_value,0 as discount
                        from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))


            union
			select 6 as grp_title ,12 AS serial,' Miscelleneous Charge ' as col_name,sum(a.MISCELLENEOUS_CHARGE ) as col_value,0 as discount
                        from  indoor_pat_DEPT_INFO a
                          where  upper(A.doc_dept)=UPPER(p_text) AND A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)))
    union
			select 6 as grp_title ,13 AS serial,'OUTDOOR Examination Charge' as col_name, NVL(sum(total_amt),0) AS col_value ,0 AS DISCOUNT from pat_info_sub3_out_door
                                      where upper(doc_dept)=UPPER(p_text) and in_reg_no=0
                             and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))

    union
			select 6 as grp_title ,14 AS serial,'INDOOR Examination Charge' as col_name, NVL(sum(total_amt),0) AS col_value ,0 AS DISCOUNT from pat_info_sub3_out_door
                                      where upper(doc_dept)=UPPER(p_text) and in_reg_no<>0
                             and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))

			 union
			select 6 as grp_title ,15 AS serial,'  ' as col_name,0 as col_value,DISCOUNT_TOTAL  AS DISCOUNT
                    from  DUAL;

     ELSIF UPPER(P_TEXT)=UPPER('Radiology')   THEN
                     open p_test_cursor for
                       select 7 as grp_title ,1 AS serial,'Ultrasonography Charge' as col_name, NVL(sum(test_charge),0) AS col_value ,0 as discount from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code)  in (TO_NUMBER('15'))   and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
                   union
			 select 7 as grp_title ,2 AS serial,'X-ray(indoor) Charge' as col_name, NVL(sum(test_charge),0) AS col_value ,0 as discount from pat_info_sub1_out_door  where
					                m_code  in (TO_NUMBER('09')) and in_reg_no!=0 and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
                  union
			 select 7 as grp_title ,3 AS serial,'X-ray(Outdoor) Charge' as col_name, NVL(sum(test_charge),0) AS col_value,0 as discount  from pat_info_sub1_out_door  where
					                TO_NUMBER(m_code)  in (TO_NUMBER('09')) and in_reg_no=0 and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
                  union
                      select 7 as grp_title ,4 AS serial,'' as col_name,0  AS col_value,sum(disc) as discount from pat_info_sub3_out_door
                       where reg_no in (select distinct(reg_no)
                                                from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code)  in (TO_NUMBER('09'),TO_NUMBER('15'))   and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))) ;
             ELSIF UPPER(P_TEXT)=UPPER('Anaes.logy')   THEN
                open p_test_cursor for
                   select 8 as grp_title ,1 AS serial,' Anaesthesia Charge ' as col_name,sum(a.ANESTHESIA_CHARGE) as col_value,0 as discount
                  from  indoor_pat_DEPT_INFO a
                          where   A.RELEASE_FLAG=1
                         and (((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))   between 8 and 23)) or (to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(a.dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(a.dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(a.dt,'hh24'))  between 0 and 7)));
     ELSIF UPPER(P_TEXT)=UPPER('Immunization')   THEN
                     open p_test_cursor for
                       select 9 as grp_title ,1 AS serial,'Immunization Charge' as col_name, NVL(sum(test_charge),0) AS col_value ,0 as discount from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code)  in (TO_NUMBER('08'))   and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
    union
                      select 9 as grp_title ,2 AS serial,'' as col_name,0  AS col_value,sum(disc) as discount from pat_info_sub3_out_door
                       where reg_no in (select distinct(reg_no)
                                                from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code)  in (TO_NUMBER('08'))   and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7))) );
         ELSIF UPPER(P_TEXT)=UPPER('Dental')   THEN
                     open p_test_cursor for
                       select 10 as grp_title ,1 AS serial,'Dental Charge' as col_name, NVL(sum(test_charge),0) AS col_value, 0 as discount  from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code)  in (TO_NUMBER('13'))   and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
    union
                      select 10 as grp_title ,2 AS serial,'' as col_name,0  AS col_value,sum(disc) as discount from pat_info_sub3_out_door
                       where reg_no in (select distinct(reg_no)
                                                from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code)  in (TO_NUMBER('13'))   and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7))));

   ELSIF UPPER(P_TEXT)=UPPER('Emergency')   THEN
                     open p_test_cursor for
                       select 11 as grp_title ,1 AS serial,'Dressing Charge' as col_name, NVL(sum(test_charge),0) AS col_value,0 as discount  from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code)  in (TO_NUMBER('14')) and to_number(s_code)=to_number('01')  and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))

     union
     select 11 as grp_title ,2 AS serial,'Emergency Ticket' as col_name, NVL(sum(test_charge),0) AS col_value,0 as discount  from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code)  in (TO_NUMBER('14')) and to_number(s_code)=to_number('30')  and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
    union
     select 11 as grp_title ,3 AS serial,'Nebuliser Charge(Emergency)' as col_name, NVL(sum(test_charge),0) AS col_value,0 as discount  from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code)  in (TO_NUMBER('14')) and to_number(s_code)=to_number('29')  and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))

   union
     select 11 as grp_title ,4 AS serial,'Emergency Minor Operation Charge' as col_name, NVL(sum(test_charge),0) AS col_value,0 as discount  from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code)  in (TO_NUMBER('14')) and to_number(s_code)=to_number('04')  and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))


    
               union
                    select 4 as grp_title ,12 AS serial,'OUTDOOR Investigation Charge(Reff. from Emmer. to other dept.)' as col_name, NVL(sum(test_charge),0) AS col_value ,0 AS DISCOUNT from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code) not in (TO_NUMBER('14')) and doc_dept='Emmergency' and in_reg_no=0 and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
              union
                    select 4 as grp_title ,13 AS serial,'Indoor Investigation Charge(Reff. from Emmer. to other dept.)' as col_name, NVL(sum(test_charge),0) AS col_value ,0 AS DISCOUNT from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code) not in (TO_NUMBER('14')) and doc_dept='Emmergency' and  in_reg_no<>0 and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))




 
    union
                      select 11 as grp_title ,5 AS serial,'' as col_name,0  AS col_value,sum(disc) as discount from pat_info_sub3_out_door
                       where reg_no in (select distinct(reg_no)
                                                from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code)  in (TO_NUMBER('14'))   and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7))));


        ELSIF UPPER(P_TEXT)=UPPER('Physiotherapy')   THEN
                     open p_test_cursor for
                       select 12 as grp_title ,1 AS serial,'Physiotherapy Charge' as col_name, NVL(sum(test_charge),0) AS col_value ,0 as discount from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code)  in (TO_NUMBER('11'))   and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
         union
                      select 12 as grp_title ,2 AS serial,'' as col_name,0  AS col_value,sum(disc) as discount from pat_info_sub3_out_door
                       where reg_no in (select distinct(reg_no)
                                                from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code)  in (TO_NUMBER('11'))   and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7))));
   ELSIF UPPER(P_TEXT)=UPPER('Pathology')   THEN
                     open p_test_cursor for
                       select 13 as grp_title ,1 AS serial,'Pathology(Indoor)  Charge ' as col_name, NVL(sum(test_charge),0) AS col_value ,0 AS discount from pat_info_sub1_out_door  where
					                 m_code  in(TO_NUMBER('01'),TO_NUMBER('02'),TO_NUMBER('03'),TO_NUMBER('04'),TO_NUMBER('05'),TO_NUMBER('06'),TO_NUMBER('10'))
                                     and in_reg_no!=0  and
(((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
                   union
                         select 13 as grp_title ,2 AS serial,'Pathology(Outdoor)  Charge ' as col_name, NVL(sum(test_charge),0) AS col_value ,0 AS discount  from pat_info_sub1_out_door  where
					                 m_code  in(TO_NUMBER('01'),TO_NUMBER('02'),TO_NUMBER('03'),TO_NUMBER('04'),TO_NUMBER('05'),TO_NUMBER('06'),TO_NUMBER('10'))
                                     and in_reg_no=0  and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
                 union
                      select 13 as grp_title ,3 AS serial,'Blood Transfusion Charge' as col_name, NVL(sum(test_charge),0) AS col_value ,0 AS discount from pat_info_sub1_out_door  where
					                 TO_NUMBER(m_code)  in (TO_NUMBER('16'))   and (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7)))
            union
                      select 13 as grp_title ,4 AS serial,' ' as col_name,0  AS col_value,sum(disc) as discount from pat_info_sub3_out_door
                       where reg_no in (select distinct(reg_no)
                                                from pat_info_sub1_out_door  where m_code  in(TO_NUMBER('01'),TO_NUMBER('02'),TO_NUMBER('03'),TO_NUMBER('04'),TO_NUMBER('05'),TO_NUMBER('06'),TO_NUMBER('10'))
                        AND (((to_char(dt,'dd-mon-yyyy') =to_char(p_dt1
                      ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))   between 8 and 23)) or (to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy')> to_date(to_char(p_dt1,'dd-mon-yyyy'),'dd-mon-yyyy')
                       and to_date(to_char(dt,'dd-mon-yyyy'),'dd-mon-yyyy') <=to_date(to_char(p_dt2,'dd-mon-yyyy'),'dd-mon-yyyy'))
	                    or ((to_char(dt,'dd-mon-yyyy') =to_char(p_dt2+1
	                  ,'dd-mon-yyyy') and to_number(to_char(dt,'hh24'))  between 0 and 7))));
  end if;
          end if;
   end if;
end ;